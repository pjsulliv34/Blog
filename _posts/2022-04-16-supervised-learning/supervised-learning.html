<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Supervised Learning</title>

  <meta property="description" itemprop="description" content="A closer look at classification and regression analysis."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-04-16"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-04-16"/>
  <meta name="article:author" content="Peter Sullivan"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Supervised Learning"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="A closer look at classification and regression analysis."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Supervised Learning"/>
  <meta property="twitter:description" content="A closer look at classification and regression analysis."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","preview","output"]}},"value":[{"type":"character","attributes":{},"value":["Supervised Learning"]},{"type":"character","attributes":{},"value":["A closer look at classification and regression analysis.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Peter Sullivan"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["2022-04-16"]},{"type":"character","attributes":{},"value":["preview.png"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["preview.png","supervised-learning_files/anchor-4.2.2/anchor.min.js","supervised-learning_files/bowser-1.9.3/bowser.min.js","supervised-learning_files/crosstalk-1.2.0/css/crosstalk.css","supervised-learning_files/crosstalk-1.2.0/css/crosstalk.min.css","supervised-learning_files/crosstalk-1.2.0/js/crosstalk.js","supervised-learning_files/crosstalk-1.2.0/js/crosstalk.js.map","supervised-learning_files/crosstalk-1.2.0/js/crosstalk.min.js","supervised-learning_files/crosstalk-1.2.0/js/crosstalk.min.js.map","supervised-learning_files/crosstalk-1.2.0/scss/crosstalk.scss","supervised-learning_files/distill-2.2.21/template.v2.js","supervised-learning_files/figure-html5/unnamed-chunk-22-1.png","supervised-learning_files/figure-html5/unnamed-chunk-23-1.png","supervised-learning_files/figure-html5/unnamed-chunk-24-1.png","supervised-learning_files/figure-html5/unnamed-chunk-25-1.png","supervised-learning_files/figure-html5/unnamed-chunk-26-1.png","supervised-learning_files/figure-html5/unnamed-chunk-31-1.png","supervised-learning_files/figure-html5/unnamed-chunk-33-1.png","supervised-learning_files/figure-html5/unnamed-chunk-34-1.png","supervised-learning_files/figure-html5/unnamed-chunk-40-1.png","supervised-learning_files/figure-html5/unnamed-chunk-43-1.png","supervised-learning_files/figure-html5/unnamed-chunk-43-2.png","supervised-learning_files/figure-html5/unnamed-chunk-43-3.png","supervised-learning_files/figure-html5/unnamed-chunk-44-1.png","supervised-learning_files/header-attrs-2.13/header-attrs.js","supervised-learning_files/htmlwidgets-1.5.3/htmlwidgets.js","supervised-learning_files/jquery-3.6.0/jquery-3.6.0.js","supervised-learning_files/jquery-3.6.0/jquery-3.6.0.min.js","supervised-learning_files/jquery-3.6.0/jquery-3.6.0.min.map","supervised-learning_files/plotly-binding-4.9.4.1/plotly.js","supervised-learning_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css","supervised-learning_files/plotly-main-1.57.1/plotly-latest.min.js","supervised-learning_files/popper-2.6.0/popper.min.js","supervised-learning_files/tippy-6.2.7/tippy-bundle.umd.min.js","supervised-learning_files/tippy-6.2.7/tippy-light-border.css","supervised-learning_files/tippy-6.2.7/tippy.css","supervised-learning_files/tippy-6.2.7/tippy.umd.min.js","supervised-learning_files/typedarray-0.1/typedarray.min.js","supervised-learning_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="supervised-learning_files/header-attrs-2.13/header-attrs.js"></script>
  <script src="supervised-learning_files/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <script src="supervised-learning_files/plotly-binding-4.9.4.1/plotly.js"></script>
  <script src="supervised-learning_files/typedarray-0.1/typedarray.min.js"></script>
  <script src="supervised-learning_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="supervised-learning_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
  <script src="supervised-learning_files/crosstalk-1.2.0/js/crosstalk.min.js"></script>
  <link href="supervised-learning_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
  <script src="supervised-learning_files/plotly-main-1.57.1/plotly-latest.min.js"></script>
  <script src="supervised-learning_files/popper-2.6.0/popper.min.js"></script>
  <link href="supervised-learning_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="supervised-learning_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="supervised-learning_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="supervised-learning_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="supervised-learning_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="supervised-learning_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="supervised-learning_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Supervised Learning","description":"A closer look at classification and regression analysis.","authors":[{"author":"Peter Sullivan","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-04-16T00:00:00.000-04:00","citationText":"Sullivan, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Supervised Learning</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A closer look at classification and regression analysis.</p></p>
</div>

<div class="d-byline">
  Peter Sullivan true 
  
<br/>2022-04-16
</div>

<div class="d-article">
<h1 id="islr-ch.-4-exercise-16">ISLR Ch. 4, Exercise 16</h1>
<p>Using the Boston data set, fit classification models in order to
predict whether a given census tract has a crime rate above or below the
median. Explore logistic regression, LDA, naive Bayes, and KNN models
using various subsets of the predictors. Describe your findings. Hint:
You will have to create the response variable yourself, using the
variables that are contained in the Boston data set.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>crim</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
 0.00632  0.08204  0.25651  3.61352  3.67708 88.97620 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Boston</span><span class='op'>$</span><span class='va'>response</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>crim</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>crim</span><span class='op'>)</span>,<span class='st'>"Above"</span>,<span class='st'>"Below"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Boston</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>response</span><span class='op'>==</span><span class='st'>"Above"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>     crim zn indus chas   nox    rm  age    dis rad tax ptratio lstat
1 0.62976  0  8.14    0 0.538 5.949 61.8 4.7075   4 307      21  8.26
2 0.63796  0  8.14    0 0.538 6.096 84.5 4.4619   4 307      21 10.26
3 0.62739  0  8.14    0 0.538 5.834 56.5 4.4986   4 307      21  8.47
4 1.05393  0  8.14    0 0.538 5.935 29.3 4.4986   4 307      21  6.58
5 0.78420  0  8.14    0 0.538 5.990 81.7 4.2579   4 307      21 14.67
6 0.80271  0  8.14    0 0.538 5.456 36.6 3.7965   4 307      21 11.69
  medv response
1 20.4    Above
2 18.2    Above
3 19.9    Above
4 23.1    Above
5 17.5    Above
6 20.2    Above</code></pre>
</div>
<h3 id="set-up-training-and-test-sets">Set up Training and Test
Sets</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>

<span class='va'>train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>Boston.test</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>
<span class='va'>boston.response</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>$</span><span class='va'>response</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span>
<span class='va'>boston.train</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>
</code></pre>
</div>
</div>
<h3 id="logistic-regression">Logistic Regression</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>glm.fits</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>response</span> <span class='op'>~</span> <span class='va'>zn</span> <span class='op'>+</span> <span class='va'>indus</span><span class='op'>+</span><span class='va'>chas</span><span class='op'>+</span><span class='va'>nox</span><span class='op'>+</span><span class='va'>rm</span><span class='op'>+</span><span class='va'>age</span><span class='op'>+</span><span class='va'>dis</span><span class='op'>+</span><span class='va'>rad</span><span class='op'>+</span><span class='va'>tax</span>, family <span class='op'>=</span> <span class='va'>binomial</span>, data <span class='op'>=</span> <span class='va'>Boston</span>, subset <span class='op'>=</span> <span class='va'>train</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>glm.fits</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
glm(formula = response ~ zn + indus + chas + nox + rm + age + 
    dis + rad + tax, family = binomial, data = Boston, subset = train)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-3.05155  -0.00772   0.00850   0.28098   1.80684  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  24.861723   4.752476   5.231 1.68e-07 ***
zn            0.061220   0.031442   1.947 0.051524 .  
indus         0.008342   0.047150   0.177 0.859563    
chas         -0.125309   0.847579  -0.148 0.882467    
nox         -34.478533   6.935623  -4.971 6.65e-07 ***
rm           -0.515107   0.353771  -1.456 0.145381    
age          -0.011939   0.009914  -1.204 0.228468    
dis          -0.338121   0.202467  -1.670 0.094918 .  
rad          -0.594197   0.153996  -3.859 0.000114 ***
tax           0.005827   0.002710   2.151 0.031508 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 526.53  on 379  degrees of freedom
Residual deviance: 175.75  on 370  degrees of freedom
AIC: 195.75

Number of Fisher Scoring iterations: 9</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#coef(glm.fits)</span>
<span class='co'>#summary(glm.fits)$coef</span>


<span class='va'>glm.probs</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>glm.fits</span>, type <span class='op'>=</span> <span class='st'>"response"</span>, <span class='va'>Boston.test</span><span class='op'>)</span>
<span class='co'>#glm.probs %&gt;% head()</span>

<span class='fu'><a href='https://rdrr.io/r/stats/contrasts.html'>contrasts</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>      Below
Above     0
Below     1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#length(glm.probs)</span>
<span class='co'>#dim(Boston)</span>
<span class='va'>glm.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Above"</span>,<span class='fl'>126</span><span class='op'>)</span>
<span class='va'>glm.pred</span><span class='op'>[</span><span class='va'>glm.probs</span> <span class='op'>&gt;</span><span class='fl'>.5</span> <span class='op'>]</span> <span class='op'>=</span> <span class='st'>"Below"</span>
<span class='co'>#Boston$response %&gt;% length()</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>glm.pred</span>,<span class='va'>boston.response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        boston.response
glm.pred Above Below
   Above    55     3
   Below    13    55</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>glm.pred</span><span class='op'>==</span><span class='va'>boston.response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.8730159</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>acc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>glm.pred</span><span class='op'>==</span><span class='va'>boston.response</span><span class='op'>)</span>

<span class='va'>Prediction_Accuracy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"Model"</span> <span class='op'>=</span> <span class='st'>"Logistic Regression"</span>, <span class='st'>"Accuracy"</span> <span class='op'>=</span> <span class='va'>acc</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>This means we were correct 87% of the time using the logistic
analysis in predicting whether the crime level would be above the median
using the variables chosen.</p>
<h3 id="lda-linear-discriminant-analysis">LDA (Linear Discriminant
Analysis)</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>MASS</a></span><span class='op'>)</span>

<span class='va'>lda.fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/MASS/man/lda.html'>lda</a></span><span class='op'>(</span><span class='va'>response</span> <span class='op'>~</span> <span class='va'>zn</span> <span class='op'>+</span> <span class='va'>indus</span><span class='op'>+</span><span class='va'>chas</span><span class='op'>+</span><span class='va'>nox</span><span class='op'>+</span><span class='va'>rm</span><span class='op'>+</span><span class='va'>age</span><span class='op'>+</span><span class='va'>dis</span><span class='op'>+</span><span class='va'>rad</span><span class='op'>+</span><span class='va'>tax</span>, data <span class='op'>=</span> <span class='va'>Boston</span><span class='op'>)</span>
<span class='co'>#summary(lda.fit)</span>
<span class='va'>lda.fit</span>
</code></pre>
</div>
<pre><code>Call:
lda(response ~ zn + indus + chas + nox + rm + age + dis + rad + 
    tax, data = Boston)

Prior probabilities of groups:
Above Below 
  0.5   0.5 

Group means:
             zn     indus       chas       nox       rm      age
Above  1.201581 15.271265 0.08695652 0.6384190 6.174874 85.83953
Below 21.525692  7.002292 0.05138340 0.4709711 6.394395 51.31028
           dis       rad      tax
Above 2.498489 14.940711 510.7312
Below 5.091596  4.158103 305.7431

Coefficients of linear discriminants:
               LD1
zn     0.004312445
indus -0.014204281
chas  -0.029319347
nox   -7.380732435
rm    -0.253144266
age   -0.010855144
dis    0.010054637
rad   -0.084063067
tax    0.001263545</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lda.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lda.fit</span>,<span class='va'>Boston</span><span class='op'>)</span>
<span class='va'>lda.class</span> <span class='op'>&lt;-</span> <span class='va'>lda.pred</span><span class='op'>$</span><span class='va'>class</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>lda.class</span>,<span class='va'>Boston</span><span class='op'>$</span><span class='va'>response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         
lda.class Above Below
    Above   194    14
    Below    59   239</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>lda.class</span><span class='op'>==</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.8557312</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>acc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>lda.class</span><span class='op'>==</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>response</span><span class='op'>)</span>

<span class='va'>Prediction_Accuracy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>Prediction_Accuracy</span>,  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LDA"</span>, <span class='va'>acc</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>For LDA, 86% of predictions were correct. <br /></p>
<h3 id="naive-bayes">Naive Bayes</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>e1071</span><span class='op'>)</span>

<span class='va'>nb.fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/e1071/man/naiveBayes.html'>naiveBayes</a></span><span class='op'>(</span><span class='va'>response</span> <span class='op'>~</span> <span class='va'>zn</span> <span class='op'>+</span> <span class='va'>indus</span><span class='op'>+</span><span class='va'>chas</span><span class='op'>+</span><span class='va'>nox</span><span class='op'>+</span><span class='va'>rm</span><span class='op'>+</span><span class='va'>age</span><span class='op'>+</span><span class='va'>dis</span><span class='op'>+</span><span class='va'>rad</span><span class='op'>+</span><span class='va'>tax</span>, family <span class='op'>=</span> <span class='va'>binomial</span>, data <span class='op'>=</span> <span class='va'>Boston</span>, subset <span class='op'>=</span> <span class='va'>train</span><span class='op'>)</span>
<span class='co'>#nb.fit</span>

<span class='va'>nb.class</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>nb.fit</span>, <span class='va'>Boston.test</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>nb.class</span>, <span class='va'>boston.response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        boston.response
nb.class Above Below
   Above    52    11
   Below    16    47</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>nb.class</span> <span class='op'>==</span> <span class='va'>boston.response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.7857143</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>acc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>lda.class</span><span class='op'>==</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>response</span><span class='op'>)</span>

<span class='va'>Prediction_Accuracy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>Prediction_Accuracy</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Naive Bayes"</span>, <span class='va'>acc</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Using Naive Bayes, we were able to get a prediction accuracy of 78%.
<br /></p>
<h3 id="k-nearest-neighbors">K nearest Neighbors</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>class</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/attach.html'>attach</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
<span class='co'>#Boston %&gt;% dim()</span>
<span class='va'>train.x</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>[</span><span class='va'>train</span>,<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"zn"</span>,<span class='st'>"indus"</span>,<span class='st'>"chas"</span>,<span class='st'>"nox"</span>,<span class='st'>"rm"</span>,<span class='st'>"age"</span>,<span class='st'>"dis"</span>,<span class='st'>"rad"</span>,<span class='st'>"tax"</span><span class='op'>)</span><span class='op'>]</span>

<span class='va'>test.x</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"zn"</span>,<span class='st'>"indus"</span>,<span class='st'>"chas"</span>,<span class='st'>"nox"</span>,<span class='st'>"rm"</span>,<span class='st'>"age"</span>,<span class='st'>"dis"</span>,<span class='st'>"rad"</span>,<span class='st'>"tax"</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>train.response</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>$</span><span class='va'>response</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>
<span class='va'>test.response</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>$</span><span class='va'>response</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span>
<span class='co'>#train.x %&gt;% dim()</span>
<span class='co'>#test.x %&gt;% dim()</span>
<span class='co'>#train.response %&gt;% length()</span>

<span class='va'>knn.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/class/man/knn.html'>knn</a></span><span class='op'>(</span><span class='va'>train.x</span>,<span class='va'>test.x</span>, <span class='va'>train.response</span>, k <span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='co'>#knn.pred %&gt;% length()</span>
<span class='co'>#test.response %&gt;% length()</span>
<span class='co'>#knn.pred %&gt;% length()</span>
<span class='co'>#test.response %&gt;% length()</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>knn.pred</span>,<span class='va'>test.response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        test.response
knn.pred Above Below
   Above    66     7
   Below     2    51</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Percent Accuracy with K = 1"</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>knn.pred</span> <span class='op'>==</span> <span class='va'>test.response</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Percent Accuracy with K = 1 0.928571428571429&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>knn.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/class/man/knn.html'>knn</a></span><span class='op'>(</span><span class='va'>train.x</span>,<span class='va'>test.x</span>, <span class='va'>train.response</span>, k <span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Percent Accuracy with K =3"</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>knn.pred</span> <span class='op'>==</span> <span class='va'>test.response</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Percent Accuracy with K =3 0.968253968253968&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>knn.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/class/man/knn.html'>knn</a></span><span class='op'>(</span><span class='va'>train.x</span>,<span class='va'>test.x</span>, <span class='va'>train.response</span>, k <span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Percent Accuracy with K = 5"</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>knn.pred</span> <span class='op'>==</span> <span class='va'>test.response</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Percent Accuracy with K = 5 0.952380952380952&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span><span class='op'>&lt;-</span> <span class='cn'>NULL</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>knn.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/class/man/knn.html'>knn</a></span><span class='op'>(</span><span class='va'>train.x</span>,<span class='va'>test.x</span>, <span class='va'>train.response</span>, k <span class='op'>=</span><span class='va'>i</span><span class='op'>)</span>
  <span class='va'>x</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>knn.pred</span> <span class='op'>==</span> <span class='va'>test.response</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>y</span>,<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>"Kvalue"</span> <span class='op'>=</span> <span class='va'>y</span>, <span class='st'>"Accuracy"</span> <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Kvalue</th>
<th style="text-align: right;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.9682540</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.9682540</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.9603175</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.9523810</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.9285714</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.9285714</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>knn.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/class/man/knn.html'>knn</a></span><span class='op'>(</span><span class='va'>train.x</span>,<span class='va'>test.x</span>, <span class='va'>train.response</span>, k <span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>acc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>knn.pred</span> <span class='op'>==</span> <span class='va'>test.response</span><span class='op'>)</span>

<span class='va'>Prediction_Accuracy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>Prediction_Accuracy</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"KNN"</span>, <span class='va'>acc</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In order to set up the KNN model, I needed to create 4 data sets. A
training and Testing data set, and a test response, and training
response. I then decided to run the model and use various values of K.
The first bit of code is a bit inefficient in deciding the best value of
K. This can be seen in the first 3 predictions for K = 1, 3, and 5.</p>
<p>In order to find the best value of K, I decided to create a loop that
would try every K value from 1 to 100 and store the models % accuracy in
a vector named x. I then created a dataframe to visualize the x values
and the corresponding K values used.</p>
<p>Using KNN, I created 100 models with a k value form 1 to 100. The top
6 are listed above. The K value of 3 was the best value for K.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Prediction_Accuracy</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>Accuracy</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: left;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">KNN</td>
<td style="text-align: left;">0.968253968253968</td>
</tr>
<tr class="even">
<td style="text-align: left;">Logistic Regression</td>
<td style="text-align: left;">0.873015873015873</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LDA</td>
<td style="text-align: left;">0.855731225296443</td>
</tr>
<tr class="even">
<td style="text-align: left;">Naive Bayes</td>
<td style="text-align: left;">0.855731225296443</td>
</tr>
</tbody>
</table>
</div>
<p>I would recommend using the KNN to predict whether a crime level will
be higher than the median for the Boston data set. It has the highest
accuracy at 97%.</p>
<p><br /></p>
<h1 id="islr-ch.-5-exercise-3-or-substitute-advanced-exercise-2">ISLR
Ch. 5, Exercise 3 (or substitute advanced: Exercise 2)</h1>
<p><img src="pics/problem3.png" /></p>
<h3 id="a.">A.</h3>
<p>K fold is implemented by dividing the set of cases into a number of
groups which is dictated by K. Each group will have an equal length.</p>
<p>The first group is the validation set. The model is trained on the
other groups. So if we had a value of 10 for K. Group 1 would be the
validation set and the 9 other groups would be the training groups. A
Mean squared error is calculated for the group. This process will be
carried out for each group. At the end we will have a MSE for each
group. Finally, we take the average of all the MSE’s and that gives us
the k fold CV estimate.</p>
<h3 id="b.">B.</h3>
<p>The Validation Set Approach:</p>
<p>If K is set to low, then it approaches the same as using the
validation set approach. Test Error rate will most likely be higher in
the validation approach when compared to kfold validation.</p>
<p>Validation set approach will most likely have a high bias and cause
over fitting when compared to the k fold approach.</p>
<p>LOOCV:</p>
<p>Computation advantage when using kfold versus LOOCV. K fold will
require less computation/resources/time, then compared to the LOOCV.</p>
<p>LOOCV has less bias, which means less overfitting when applied to
other datasets, but will have more variance when compared to K fold and
when compared to the validation set approach.</p>
<p><br /></p>
<h1 id="islr-ch.-5-exercise-5">ISLR Ch. 5, Exercise 5</h1>
<img src="pics/5_3_A.png" /> <img src="pics/problem5_b.png" />
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>5</span><span class='op'>)</span>

<span class='va'>Data</span> <span class='op'>&lt;-</span> <span class='va'>Default</span>
<span class='co'>#Data %&gt;% head()</span>
<span class='co'>#Data %&gt;% names()</span>

<span class='va'>train</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#train %&gt;% length()</span>
<span class='co'>#Data %&gt;% dim()</span>


<span class='co'>### Create training Sets</span>
<span class='va'>Data.test</span> <span class='op'>&lt;-</span> <span class='va'>Data</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>
<span class='va'>Data.response</span> <span class='op'>&lt;-</span> <span class='va'>Data</span><span class='op'>$</span><span class='va'>default</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span>


<span class='co'># Fit model</span>
<span class='va'>glm.fits</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>default</span> <span class='op'>~</span> <span class='va'>income</span><span class='op'>+</span><span class='va'>balance</span>, family <span class='op'>=</span> <span class='va'>binomial</span>, data <span class='op'>=</span> <span class='va'>Data</span>, subset <span class='op'>=</span> <span class='va'>train</span><span class='op'>)</span>
<span class='co'>#summary(glm.fits)</span>
<span class='co'>#coef(glm.fits)</span>
<span class='co'>#summary(glm.fits)$coef</span>
<span class='va'>glm.probs</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>glm.fits</span>, type <span class='op'>=</span> <span class='st'>"response"</span>, <span class='va'>Data.test</span><span class='op'>)</span>


<span class='fu'><a href='https://rdrr.io/r/stats/contrasts.html'>contrasts</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>$</span><span class='va'>default</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>    Yes
No    0
Yes   1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#length(glm.probs)</span>
<span class='co'>#dim(Data.test)</span>
<span class='va'>glm.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"No"</span>,<span class='fl'>2500</span><span class='op'>)</span>
<span class='va'>glm.pred</span><span class='op'>[</span><span class='va'>glm.probs</span> <span class='op'>&gt;</span><span class='fl'>.5</span> <span class='op'>]</span> <span class='op'>=</span> <span class='st'>"Yes"</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>glm.pred</span>,<span class='va'>Data.response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        Data.response
glm.pred   No  Yes
     No  2417   48
     Yes    7   28</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>glm.pred</span><span class='op'>==</span><span class='va'>Data.response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.978</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"The test Error Rate is : "</span>,<span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>glm.pred</span><span class='op'>==</span><span class='va'>Data.response</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>,<span class='st'>"%"</span> <span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The test Error Rate is : 2.2%&quot;</code></pre>
</div>
<p><img src="pics/problem5_c.png" /> <br /></p>
<p>For this problem, we will run the sample function 3 times to get a
different training set. I will fit the model, and then I will calculate
the test error rate again. For ease, I will create a loop. I create a
new seed each time I run the loop.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span>
<span class='va'>train</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Data</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Create training Sets</span>
<span class='va'>Data.test</span> <span class='op'>&lt;-</span> <span class='va'>Data</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>
<span class='va'>Data.response</span> <span class='op'>&lt;-</span> <span class='va'>Data</span><span class='op'>$</span><span class='va'>default</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span>
<span class='co'># Fit model</span>
<span class='va'>glm.fits</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>default</span> <span class='op'>~</span> <span class='va'>income</span><span class='op'>+</span><span class='va'>balance</span>, family <span class='op'>=</span> <span class='va'>binomial</span>, data <span class='op'>=</span> <span class='va'>Data</span>, subset <span class='op'>=</span> <span class='va'>train</span><span class='op'>)</span>
<span class='va'>glm.probs</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>glm.fits</span>, type <span class='op'>=</span> <span class='st'>"response"</span>, <span class='va'>Data.test</span><span class='op'>)</span>
<span class='va'>glm.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"No"</span>,<span class='fl'>2500</span><span class='op'>)</span>
<span class='va'>glm.pred</span><span class='op'>[</span><span class='va'>glm.probs</span> <span class='op'>&gt;</span><span class='fl'>.5</span> <span class='op'>]</span> <span class='op'>=</span> <span class='st'>"Yes"</span>
<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>glm.pred</span><span class='op'>==</span><span class='va'>Data.response</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"The test Error Rate is : "</span>,<span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>glm.pred</span><span class='op'>==</span><span class='va'>Data.response</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>,<span class='st'>"%"</span> <span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
<pre><code>[1] &quot;The test Error Rate is : 2.6%&quot;
[1] &quot;The test Error Rate is : 2.12%&quot;
[1] &quot;The test Error Rate is : 2.6%&quot;</code></pre>
</div>
<p>When Running the model with 3 different seeds. I saw that the error
rate fluctuated from 2.12 % up to 2.6%.</p>
<p><img src="pics/prob5_d.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>glm.fits</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>default</span> <span class='op'>~</span> <span class='va'>.</span>, family <span class='op'>=</span> <span class='va'>binomial</span>, data <span class='op'>=</span> <span class='va'>Data</span>, subset <span class='op'>=</span> <span class='va'>train</span><span class='op'>)</span>
<span class='va'>glm.probs</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>glm.fits</span>, type <span class='op'>=</span> <span class='st'>"response"</span>, <span class='va'>Data.test</span><span class='op'>)</span>
<span class='va'>glm.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"No"</span>,<span class='fl'>2500</span><span class='op'>)</span>
<span class='va'>glm.pred</span><span class='op'>[</span><span class='va'>glm.probs</span> <span class='op'>&gt;</span><span class='fl'>.5</span> <span class='op'>]</span> <span class='op'>=</span> <span class='st'>"Yes"</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>glm.pred</span>,<span class='va'>Data.response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        Data.response
glm.pred   No  Yes
     No  2416   54
     Yes   13   17</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>glm.pred</span><span class='op'>==</span><span class='va'>Data.response</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0.9732</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"The test Error Rate is : "</span>,<span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>glm.pred</span><span class='op'>==</span><span class='va'>Data.response</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>,<span class='st'>"%"</span> <span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The test Error Rate is : 2.68%&quot;</code></pre>
</div>
<p>Using the dummy variable is about the same as the last error rate
calculated in part c (2.68). I’m comparing it to that result, since the
current sample seed is the one used in that loop.</p>
<p><br /></p>
<h1 id="islr-ch.-5-exercise-9">ISLR Ch. 5, Exercise 9</h1>
<p><img src="pics/prob9_a.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>u_</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>$</span><span class='va'>medv</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The population mean of the medv:"</span>,<span class='va'>u_</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The population mean of the medv: 22.5328063241107&quot;</code></pre>
</div>
<p><img src="pics/prob9_b.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sd_error</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>$</span><span class='va'>medv</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The Standard error of the sample mean is:"</span>, <span class='va'>sd_error</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The Standard error of the sample mean is: 2.45802946039096&quot;</code></pre>
</div>
<img src="pics/prob9_c.png" />
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>boot</span><span class='op'>)</span>

<span class='va'>alpha.fn</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>index</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>medv</span> <span class='op'>&lt;-</span><span class='va'>data</span><span class='op'>$</span><span class='va'>medv</span><span class='op'>[</span><span class='va'>index</span><span class='op'>]</span>
  <span class='va'>mean_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>medv</span><span class='op'>)</span>
 
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Boston$medv %&gt;% length()</span>


<span class='fu'><a href='https://rdrr.io/pkg/boot/man/boot.html'>boot</a></span><span class='op'>(</span><span class='va'>Boston</span>, <span class='va'>alpha.fn</span>,<span class='fl'>10000</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot(data = Boston, statistic = alpha.fn, R = 10000)


Bootstrap Statistics :
    original       bias    std. error
t1* 22.53281 0.0006395257    0.407591</code></pre>
</div>
<p>The standard error is lower using the Bootstrap when compared to the
answer from part c.</p>
<p><img src="pics/prob9_d.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/t.test.html'>t.test</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>medv</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    One Sample t-test

data:  Boston$medv
t = 55.111, df = 505, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 21.72953 23.33608
sample estimates:
mean of x 
 22.53281 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mean_boot</span> <span class='op'>&lt;-</span> <span class='fl'>22.53281</span>
<span class='va'>std.boot</span> <span class='op'>&lt;-</span> <span class='fl'>.4137494</span>

<span class='va'>upperbound</span> <span class='op'>&lt;-</span> <span class='va'>mean_boot</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>*</span><span class='va'>std.boot</span>
<span class='va'>lowerbound</span> <span class='op'>&lt;-</span> <span class='va'>mean_boot</span> <span class='op'>-</span><span class='fl'>2</span><span class='op'>*</span><span class='va'>std.boot</span>

<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"The confidence interval using the boot: ["</span>,<span class='va'>lowerbound</span>,<span class='st'>" , "</span>,<span class='va'>upperbound</span>,<span class='st'>"]"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The confidence interval using the boot: [21.7053112 , 23.3603088]&quot;</code></pre>
</div>
<p><br /></p>
<p>The boot and the t test confidence intervals are very close, almost
identical.</p>
<p><br /></p>
<img src="pics/prob9_e.png" />
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The median value of medv in the population"</span>, <span class='va'>Boston</span><span class='op'>$</span><span class='va'>medv</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The median value of medv in the population 21.2&quot;</code></pre>
</div>
<p><img src="pics/prob9_f.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>alpha.median</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>index</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>medv</span> <span class='op'>&lt;-</span><span class='va'>data</span><span class='op'>$</span><span class='va'>medv</span><span class='op'>[</span><span class='va'>index</span><span class='op'>]</span>
  <span class='va'>median_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>medv</span><span class='op'>)</span>

<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/pkg/boot/man/boot.html'>boot</a></span><span class='op'>(</span><span class='va'>Boston</span>, <span class='va'>alpha.median</span>, <span class='fl'>10000</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot(data = Boston, statistic = alpha.median, R = 10000)


Bootstrap Statistics :
    original    bias    std. error
t1*     21.2 -0.013115   0.3808402</code></pre>
</div>
<p>The standard error of the median is .3768. This standard error is
very small for the original median of 21.2.</p>
<p><img src="pics/prob9_g.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>medv</span>, probs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>,<span class='fl'>.2</span>,<span class='fl'>.5</span>,<span class='fl'>.75</span>,<span class='fl'>.9</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  10%   20%   50%   75%   90% 
12.75 15.30 21.20 25.00 34.80 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The 10th percentile is :"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>$</span><span class='va'>medv</span>, probs <span class='op'>=</span> <span class='fl'>.1</span><span class='op'>)</span>,<span class='st'>"%"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The 10th percentile is : 12.75 %&quot;</code></pre>
</div>
<p><img src="pics/prob9_h.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>alpha.quantile</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>index</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>medv</span> <span class='op'>&lt;-</span><span class='va'>data</span><span class='op'>$</span><span class='va'>medv</span><span class='op'>[</span><span class='va'>index</span><span class='op'>]</span>
  <span class='va'>perc_10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>medv</span>, probs <span class='op'>=</span> <span class='fl'>.1</span><span class='op'>)</span>

<span class='op'>}</span>

<span class='fu'><a href='https://rdrr.io/pkg/boot/man/boot.html'>boot</a></span><span class='op'>(</span><span class='va'>Boston</span>, <span class='va'>alpha.quantile</span>, <span class='fl'>10000</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
ORDINARY NONPARAMETRIC BOOTSTRAP


Call:
boot(data = Boston, statistic = alpha.quantile, R = 10000)


Bootstrap Statistics :
    original   bias    std. error
t1*    12.75 0.007025   0.4981081</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/detach.html'>detach</a></span><span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The standard error for the 10% quantile is .5 for a original value of
12.75.</p>
<p><br /></p>
<h1 id="islr-ch.-6-exercise-2">ISLR Ch. 6, Exercise 2</h1>
<p>Referenced Article: <a
href="https://towardsdatascience.com/understanding-the-bias-variance-tradeoff-165e6942b229"
class="uri">https://towardsdatascience.com/understanding-the-bias-variance-tradeoff-165e6942b229</a></p>
<p>I found this article helpful in understanding accuracy with reference
to bias/variance tradeoff.</p>
<p>Figure 2.7 in Textbook also helped with flexibility of different
models.</p>
<p><img src="pics/prob6.png" /></p>
<h3 id="a.-1">A.</h3>
<h4 id="i">I</h4>
<p>More flexible and hence will give improved prediction accuracy when
its increase in bias is less than its decrease in variance.</p>
<p>Incorrect. Lasso is less flexible than Least squares.</p>
<h4 id="ii">II</h4>
<p>More flexible and hence will give improved prediction accuracy when
its increase in variance is less than its decrease in bias.</p>
<p>Incorrect - less flexible than OLS</p>
<h4 id="iii">III</h4>
<p>Less flexible and hence will give improved prediction accuracy when
its increase in bias is less than its decrease in variance.</p>
<p>Correct - Low bias and high variance will cause overfitting, but will
have a higher prediction accuracy than underfitting the data. since the
variance is not increasing, we will have more coefficents that explain
the response being measuared, and lamda will not go to zero for those
predictors.</p>
<h4 id="iv">IV</h4>
<p>Less flexible and hence will give improved prediction accuracy when
its increase in variance is less than its decrease in bias.</p>
<p>Incorrect - Increase in variance &lt; then decrease in bias would
give a situation of high variance and high bias.</p>
<p>Also this is not how the lasso works, lambda will get rid of the
variables that have high variance, by setting their cofficents to</p>
<h3 id="b">B</h3>
<p>Repeat (a) for ridge regression relative to least squares.</p>
<h4 id="i-1">i</h4>
<p>Incorrect - Less Flexible</p>
<h4 id="ii-1">II</h4>
<p>Incorrect - Less Flexible</p>
<h4 id="iii-1">III</h4>
<p>Correct - As lamda increases bias, flexibility decreases, which means
we get a decreased variance and increased bias.</p>
<p>Slight increase in bias with less variance increases prediction
accuracy.</p>
<h4 id="iv-1">IV</h4>
<p>Incorrect. Larger increase in varriance associated with smaller
decrease in bias would not improve prediction accuracy.</p>
<h3 id="c">C</h3>
<p>Repeat (a) for non-linear methods relative to least squares.</p>
<h4 id="i-2">i</h4>
<p>Correct - More flexible model, Slight increase in bias with less
variance increases prediction accuracy.</p>
<h4 id="ii-iv">ii-iV</h4>
<p>Incorrect.</p>
<p><br /></p>
<h1 id="islr-ch.-6-exercise-9">ISLR Ch. 6, Exercise 9</h1>
<p>(omit e &amp; f) (requires time and effort; please collaborate &amp;
use Piazza)</p>
<p>In this exercise, we will predict the number of applications received
using the other variables in the College data set.</p>
<h3 id="a">A</h3>
<p>Split the data set into a training set and a test set.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.statlearning.com'>ISLR2</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'>#College %&gt;% dim()</span>
<span class='co'>#College %&gt;% names()</span>
<span class='co'>#College %&gt;% head()</span>
<span class='co'>#?College</span>

<span class='va'>train</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>College</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>College</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>3</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#train %&gt;% length()</span>
<span class='co'>#train %&gt;% head()</span>



<span class='co'># Create Test actuals and training Sets</span>

<span class='va'>College.test</span> <span class='op'>&lt;-</span> <span class='va'>College</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>
<span class='va'>College.response</span> <span class='op'>&lt;-</span> <span class='va'>College</span><span class='op'>$</span><span class='va'>Apps</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span>
<span class='va'>college.train</span> <span class='op'>&lt;-</span> <span class='va'>College</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>
</code></pre>
</div>
</div>
<p>After looking into College data set, I identified that our response
variable will be the column Apps. The training set will be the college
dataframe filtered on the train index.</p>
<h3 id="b-1">B</h3>
<p>Fit a linear model using least squares on the training set, and
report the test error obtained.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/attach.html'>attach</a></span><span class='op'>(</span><span class='va'>College</span><span class='op'>)</span>
<span class='va'>lm.fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>Apps</span> <span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>College</span>, subset <span class='op'>=</span> <span class='va'>train</span><span class='op'>)</span>
<span class='va'>lm.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lm.fit</span>, <span class='va'>College.test</span>, type <span class='op'>=</span> <span class='st'>"response"</span><span class='op'>)</span>
<span class='va'>lm_mse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>College.response</span> <span class='op'>-</span><span class='va'>lm.pred</span> <span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>lm_mse</span>
</code></pre>
</div>
<pre><code>[1] 1389123</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>"model"</span> <span class='op'>=</span> <span class='st'>"Least Square"</span>, <span class='st'>"MSE"</span> <span class='op'>=</span> <span class='va'>lm_mse</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="c-1">C</h3>
<p>Fit a ridge regression model on the training set, with λ chosen by
cross-validation. Report the test error obtained.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glmnet.stanford.edu'>glmnet</a></span><span class='op'>)</span>


<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>Apps</span><span class='op'>~</span><span class='va'>.</span>,<span class='va'>College</span><span class='op'>)</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>College</span><span class='op'>$</span><span class='va'>Apps</span>
<span class='va'>grid</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='op'>-</span><span class='fl'>2</span>, length <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='va'>ridge.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>, <span class='va'>y</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>, alpha <span class='op'>=</span><span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span> <span class='op'>)</span>
<span class='va'>cv.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>, <span class='va'>y</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>,alpha <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.out</span><span class='op'>)</span>
</code></pre>
</div>
<img src="supervised-learning_files/figure-html5/unnamed-chunk-22-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lamda_best</span> <span class='op'>&lt;-</span> <span class='va'>cv.out</span><span class='op'>$</span><span class='va'>lambda.min</span>
<span class='va'>lamda_best</span>
</code></pre>
</div>
<pre><code>[1] 364.3384</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='va'>lamda_best</span>, newx <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='va'>ridge_mse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ridge"</span>,<span class='va'>ridge_mse</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The test Error Rate is : "</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The test Error Rate is :  1204431.39092091&quot;</code></pre>
</div>
<h3 id="d">D</h3>
<p>Fit a lasso model on the training set, with λ chosen by
crossvalidation. Report the test error obtained, along with the number
of non-zero coefficient estimates.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lasso.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>,<span class='va'>y</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>,alpha <span class='op'>=</span> <span class='fl'>1</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>
<span class='va'>cv.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>, <span class='va'>y</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.out</span><span class='op'>)</span>
</code></pre>
</div>
<img src="supervised-learning_files/figure-html5/unnamed-chunk-23-1.png" width="624" data-distill-preview=1 />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lamda_best</span> <span class='op'>&lt;-</span> <span class='va'>cv.out</span><span class='op'>$</span><span class='va'>lambda.min</span>
<span class='va'>lamda_best</span>
</code></pre>
</div>
<pre><code>[1] 2.133937</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lasso.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lasso.mod</span>, s<span class='op'>=</span> <span class='va'>lamda_best</span>, newx <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The test error rate is "</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>lasso.pred</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The test error rate is  1374692.34765744&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lasso_mse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>lasso.pred</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>

<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>, alpha <span class='op'>=</span> <span class='fl'>1</span> ,lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>
<span class='va'>lamda.coef</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>out</span>, type <span class='op'>=</span> <span class='st'>"coefficients"</span>, s<span class='op'>=</span> <span class='va'>lamda_best</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>18</span>,<span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The number of non-zero coeficients:"</span>,<span class='va'>lamda.coef</span><span class='op'>[</span><span class='va'>lamda.coef</span> <span class='op'>!=</span><span class='fl'>0</span><span class='op'>]</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The number of non-zero coeficients: 18&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Lasso"</span>,<span class='va'>lasso_mse</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>None of the coefficients are zero.</p>
<h3 id="e">E</h3>
<p>Fit a PCR model on the training set, with M chosen by
crossvalidation. Report the test error obtained, along with the value of
M selected by cross-validation.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/khliland/pls'>pls</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>pcr.fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/pls/man/mvr.html'>pcr</a></span><span class='op'>(</span><span class='va'>Apps</span> <span class='op'>~</span> <span class='va'>.</span> , data <span class='op'>=</span> <span class='va'>College</span>, subset <span class='op'>=</span> <span class='va'>train</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, validation <span class='op'>=</span> <span class='st'>"CV"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/pls/man/validationplot.html'>validationplot</a></span><span class='op'>(</span><span class='va'>pcr.fit</span>, val.type <span class='op'>=</span> <span class='st'>"MSEP"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="supervised-learning_files/figure-html5/unnamed-chunk-24-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pcr.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>pcr.fit</span>,<span class='va'>College.test</span>, ncomp <span class='op'>=</span> <span class='fl'>17</span><span class='op'>)</span>
<span class='va'>pcr_mse</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>pcr.pred</span> <span class='op'>-</span> <span class='va'>College.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The MSE error is "</span>, <span class='va'>pcr_mse</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The MSE error is  1389123.27022729&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PCR"</span>,<span class='va'>pcr_mse</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>From the validation plot, the lowest MSEP for the number of
components is around 16,17, and 18.I decided to use 17 as my value of
M.</p>
<h3 id="f">F</h3>
<p>Fit a PLS model on the training set, with M chosen by
crossvalidation. Report the test error obtained, along with the value of
M selected by cross-validation.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pls.fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/pls/man/mvr.html'>plsr</a></span><span class='op'>(</span><span class='va'>Apps</span><span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>College</span>, subset <span class='op'>=</span> <span class='va'>train</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, validation <span class='op'>=</span> <span class='st'>"CV"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/pls/man/validationplot.html'>validationplot</a></span><span class='op'>(</span><span class='va'>pls.fit</span>, val.type <span class='op'>=</span> <span class='st'>"MSEP"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="supervised-learning_files/figure-html5/unnamed-chunk-25-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pls.pred_7</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>pls.fit</span>, <span class='va'>College.test</span>, ncomp <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span>
<span class='va'>pls.pred_8</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>pls.fit</span>, <span class='va'>College.test</span>, ncomp <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The MSE error using M as 7: "</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>pls.pred_7</span><span class='op'>-</span> <span class='va'>College.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The MSE error using M as 7:  1336641.93400001&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The MSE error using M as 8: "</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>pls.pred_8</span><span class='op'>-</span> <span class='va'>College.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The MSE error using M as 8:  1362535.73332994&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pls_mse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>pls.pred_8</span><span class='op'>-</span> <span class='va'>College.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PLS"</span>,<span class='va'>pls_mse</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The number of components ranges from 7 to 8. I will predict using
both values of M.</p>
<h3 id="g">G</h3>
<p>Comment on the results obtained. How accurately can we predict the
number of college applications received? Is there much difference among
the test errors resulting from these five approaches?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MSE_dataframe</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>MSE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: left;">MSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ridge</td>
<td style="text-align: left;">1204431.39092091</td>
</tr>
<tr class="even">
<td style="text-align: left;">PLS</td>
<td style="text-align: left;">1362535.73332994</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lasso</td>
<td style="text-align: left;">1374692.34765744</td>
</tr>
<tr class="even">
<td style="text-align: left;">Least Square</td>
<td style="text-align: left;">1389123.27022729</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PCR</td>
<td style="text-align: left;">1389123.27022729</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MSE_dataframe</span><span class='op'>$</span><span class='va'>MSE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span><span class='op'>$</span><span class='va'>MSE</span><span class='op'>)</span>

<span class='va'>MSE_dataframe</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>model</span>, y <span class='op'>=</span> <span class='va'>MSE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"deepskyblue3"</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"MSE per Model"</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>MSE</span><span class='op'>)</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>, vjust <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="supervised-learning_files/figure-html5/unnamed-chunk-26-1.png" width="624" /></p>
</div>
<p>The Ridge regression model had the lowest MSE, with PLS coming up the
second lowest MSE, following Lasso and the PCR and Least square in last.
There is not too much of a difference between the MSE’s, it looks larger
due to the scale on the graph.</p>
<p><br /></p>
<h1 id="islr-ch.-8-exercise-4">ISLR Ch. 8, Exercise 4</h1>
<p><img src="pics/prob8_4.png" /></p>
<h3 id="a.-2">A.</h3>
<p><img src="pics/prob8_4a.jpg" /></p>
<h3 id="b-2">B</h3>
<p><img src="pics/prob8_4b.jpg" /></p>
<p><br /></p>
<h1 id="islr-ch.-8-exercise-7">ISLR Ch. 8, Exercise 7</h1>
<p><img src="pics/prob8_7.png" /></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.stat.berkeley.edu/~breiman/RandomForests/'>randomForest</a></span><span class='op'>)</span>; <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span> <span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span>, <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span> <span class='op'>(</span><span class='va'>Boston</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>3</span><span class='op'>)</span>
<span class='va'>boston.response_test</span> <span class='op'>&lt;-</span> <span class='va'>Boston</span><span class='op'>$</span><span class='va'>medv</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span>
<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"predictors"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>,<span class='st'>"ntree"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>double</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"MSE"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>double</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>


<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>13</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>for</span><span class='op'>(</span><span class='va'>x</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>600</span>,<span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>bag.boston</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/randomForest/man/randomForest.html'>randomForest</a></span><span class='op'>(</span><span class='va'>medv</span> <span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Boston</span>, subset <span class='op'>=</span> <span class='va'>train</span>, mtry <span class='op'>=</span> <span class='va'>i</span>,ntree <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>
<span class='va'>yhat.bag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>bag.boston</span>, newdata <span class='op'>=</span> <span class='va'>Boston</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='va'>mse_1</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>yhat.bag</span><span class='op'>-</span> <span class='va'>boston.response_test</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>df</span> <span class='op'>&lt;-</span><span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/add_row.html'>add_row</a></span><span class='op'>(</span>predictors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span>,ntree <span class='op'>=</span> <span class='va'>x</span>, MSE <span class='op'>=</span> <span class='va'>mse_1</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>

<span class='va'>plot</span><span class='op'>&lt;-</span> <span class='va'>df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>ntree</span>, y <span class='op'>=</span> <span class='va'>MSE</span>, group <span class='op'>=</span> <span class='va'>predictors</span>,color <span class='op'>=</span> <span class='va'>predictors</span>, linetype <span class='op'>=</span> <span class='va'>predictors</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>plotly</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/plotly/man/ggplotly.html'>ggplotly</a></span><span class='op'>(</span><span class='va'>plot</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-418ddac89d386a27b4cc" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-418ddac89d386a27b4cc">{"x":{"data":[{"x":[1,26,51,76,101,126,151,176,201,226,251,276,301,326,351,376,401,426,451,476,501,526,551,576],"y":[36.4030132360704,20.1672870413967,18.7087560009328,19.1354783627998,18.496417690562,19.1775878361241,19.2898228736319,18.4637276207247,18.2145217932484,19.3112908727648,18.2604710744005,18.8832646753751,18.3325016116797,18.5013258158174,18.5583502300008,18.0282923967408,18.8787594530618,18.7177851193332,19.1305364079644,18.3444224181792,18.4552723600292,18.0868986971722,18.4964681541742,17.8802581871862],"text":["ntree:   1<br />MSE: 36.40301<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree:  26<br />MSE: 20.16729<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree:  51<br />MSE: 18.70876<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree:  76<br />MSE: 19.13548<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 101<br />MSE: 18.49642<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 126<br />MSE: 19.17759<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 151<br />MSE: 19.28982<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 176<br />MSE: 18.46373<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 201<br />MSE: 18.21452<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 226<br />MSE: 19.31129<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 251<br />MSE: 18.26047<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 276<br />MSE: 18.88326<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 301<br />MSE: 18.33250<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 326<br />MSE: 18.50133<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 351<br />MSE: 18.55835<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 376<br />MSE: 18.02829<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 401<br />MSE: 18.87876<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 426<br />MSE: 18.71779<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 451<br />MSE: 19.13054<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 476<br />MSE: 18.34442<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 501<br />MSE: 18.45527<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 526<br />MSE: 18.08690<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 551<br />MSE: 18.49647<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 576<br />MSE: 17.88026<br />predictors: 1<br />predictors: 1<br />predictors: 1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,26,51,76,101,126,151,176,201,226,251,276,301,326,351,376,401,426,451,476,501,526,551,576],"y":[27.8376998031496,16.381568998522,16.151450555939,15.1073078911924,15.6034328258243,15.5810081577421,15.3438551453429,14.683301877896,15.2702784168452,15.3317851316579,15.0863588551852,15.5714223302754,14.9814345841696,15.3187311977802,15.526801532571,15.007413021855,15.3519339589946,15.4099309083397,15.3871500250433,15.4012488824985,15.0536589769078,15.584226152949,15.0936646237656,15.1259037440271],"text":["ntree:   1<br />MSE: 27.83770<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree:  26<br />MSE: 16.38157<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree:  51<br />MSE: 16.15145<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree:  76<br />MSE: 15.10731<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 101<br />MSE: 15.60343<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 126<br />MSE: 15.58101<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 151<br />MSE: 15.34386<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 176<br />MSE: 14.68330<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 201<br />MSE: 15.27028<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 226<br />MSE: 15.33179<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 251<br />MSE: 15.08636<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 276<br />MSE: 15.57142<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 301<br />MSE: 14.98143<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 326<br />MSE: 15.31873<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 351<br />MSE: 15.52680<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 376<br />MSE: 15.00741<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 401<br />MSE: 15.35193<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 426<br />MSE: 15.40993<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 451<br />MSE: 15.38715<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 476<br />MSE: 15.40125<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 501<br />MSE: 15.05366<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 526<br />MSE: 15.58423<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 551<br />MSE: 15.09366<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 576<br />MSE: 15.12590<br />predictors: 11<br />predictors: 11<br />predictors: 11"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(196,154,0,1)","dash":"dash"},"hoveron":"points","name":"11","legendgroup":"11","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,26,51,76,101,126,151,176,201,226,251,276,301,326,351,376,401,426,451,476,501,526,551,576],"y":[23.1885851487314,16.3271876644626,16.1047661877473,16.3791585132342,16.6291119647191,16.4217080410046,16.6730086205132,16.0405735001123,16.0220958864348,16.0493263788259,16.0666392771661,15.5211045158706,15.6571753152715,15.6984812880089,15.6301215460534,15.6347657250359,15.9207285686653,15.8682693914913,15.9122302907001,16.160446247243,15.7876944857743,16.1627848489863,15.9502883447923,16.185244746838],"text":["ntree:   1<br />MSE: 23.18859<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree:  26<br />MSE: 16.32719<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree:  51<br />MSE: 16.10477<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree:  76<br />MSE: 16.37916<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 101<br />MSE: 16.62911<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 126<br />MSE: 16.42171<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 151<br />MSE: 16.67301<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 176<br />MSE: 16.04057<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 201<br />MSE: 16.02210<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 226<br />MSE: 16.04933<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 251<br />MSE: 16.06664<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 276<br />MSE: 15.52110<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 301<br />MSE: 15.65718<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 326<br />MSE: 15.69848<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 351<br />MSE: 15.63012<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 376<br />MSE: 15.63477<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 401<br />MSE: 15.92073<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 426<br />MSE: 15.86827<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 451<br />MSE: 15.91223<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 476<br />MSE: 16.16045<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 501<br />MSE: 15.78769<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 526<br />MSE: 16.16278<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 551<br />MSE: 15.95029<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 576<br />MSE: 16.18524<br />predictors: 13<br />predictors: 13<br />predictors: 13"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(83,180,0,1)","dash":"dot"},"hoveron":"points","name":"13","legendgroup":"13","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,26,51,76,101,126,151,176,201,226,251,276,301,326,351,376,401,426,451,476,501,526,551,576],"y":[24.2867815122725,12.3097981555951,13.2899636404797,12.5922919059138,11.901794350884,11.8469873720801,11.4910846625509,11.8795585953659,11.4774907434225,12.1788916340457,11.5700539828036,11.5894458676662,11.2340814879293,11.6815794427441,11.7074766939527,11.2447940285054,11.2516583730643,11.6852042911835,11.5307976987236,11.5382852856446,11.5206350639931,11.5700853879932,11.3575994037437,11.3967207815116],"text":["ntree:   1<br />MSE: 24.28678<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree:  26<br />MSE: 12.30980<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree:  51<br />MSE: 13.28996<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree:  76<br />MSE: 12.59229<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 101<br />MSE: 11.90179<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 126<br />MSE: 11.84699<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 151<br />MSE: 11.49108<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 176<br />MSE: 11.87956<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 201<br />MSE: 11.47749<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 226<br />MSE: 12.17889<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 251<br />MSE: 11.57005<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 276<br />MSE: 11.58945<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 301<br />MSE: 11.23408<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 326<br />MSE: 11.68158<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 351<br />MSE: 11.70748<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 376<br />MSE: 11.24479<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 401<br />MSE: 11.25166<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 426<br />MSE: 11.68520<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 451<br />MSE: 11.53080<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 476<br />MSE: 11.53829<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 501<br />MSE: 11.52064<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 526<br />MSE: 11.57009<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 551<br />MSE: 11.35760<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 576<br />MSE: 11.39672<br />predictors: 3<br />predictors: 3<br />predictors: 3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,192,148,1)","dash":"dashdot"},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,26,51,76,101,126,151,176,201,226,251,276,301,326,351,376,401,426,451,476,501,526,551,576],"y":[31.3454156338068,14.2111065693747,12.2659125711638,11.6653790175755,11.9028340711658,11.9682225145091,11.8588202019782,11.7650163287732,11.5963491624945,11.7296883364314,12.3432801031288,11.7395155861203,11.9830501030999,11.9127830303761,12.1803461640039,12.6475849384718,12.0449384438374,12.4057677552547,12.2842212042761,12.3943910987525,12.0961226067077,11.8386920877585,11.8533340005994,12.2655681649624],"text":["ntree:   1<br />MSE: 31.34542<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree:  26<br />MSE: 14.21111<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree:  51<br />MSE: 12.26591<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree:  76<br />MSE: 11.66538<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 101<br />MSE: 11.90283<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 126<br />MSE: 11.96822<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 151<br />MSE: 11.85882<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 176<br />MSE: 11.76502<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 201<br />MSE: 11.59635<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 226<br />MSE: 11.72969<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 251<br />MSE: 12.34328<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 276<br />MSE: 11.73952<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 301<br />MSE: 11.98305<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 326<br />MSE: 11.91278<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 351<br />MSE: 12.18035<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 376<br />MSE: 12.64758<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 401<br />MSE: 12.04494<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 426<br />MSE: 12.40577<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 451<br />MSE: 12.28422<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 476<br />MSE: 12.39439<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 501<br />MSE: 12.09612<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 526<br />MSE: 11.83869<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 551<br />MSE: 11.85333<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 576<br />MSE: 12.26557<br />predictors: 5<br />predictors: 5<br />predictors: 5"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,182,235,1)","dash":"longdash"},"hoveron":"points","name":"5","legendgroup":"5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,26,51,76,101,126,151,176,201,226,251,276,301,326,351,376,401,426,451,476,501,526,551,576],"y":[23.7007902012248,13.1657455337221,14.0937209565992,12.6350737975176,14.1611095307225,13.4832536439717,12.7699077265545,13.2423457680251,12.9255826430514,13.0021587712479,12.6451985361649,13.5994099184761,12.7978397312921,12.9726545106415,12.7602862562019,13.0227192839547,12.900307636034,13.5060756503014,12.6563400858669,13.3638675355722,12.9117074954309,12.93785098855,13.0279022924108,12.8812600065364],"text":["ntree:   1<br />MSE: 23.70079<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree:  26<br />MSE: 13.16575<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree:  51<br />MSE: 14.09372<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree:  76<br />MSE: 12.63507<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 101<br />MSE: 14.16111<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 126<br />MSE: 13.48325<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 151<br />MSE: 12.76991<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 176<br />MSE: 13.24235<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 201<br />MSE: 12.92558<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 226<br />MSE: 13.00216<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 251<br />MSE: 12.64520<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 276<br />MSE: 13.59941<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 301<br />MSE: 12.79784<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 326<br />MSE: 12.97265<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 351<br />MSE: 12.76029<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 376<br />MSE: 13.02272<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 401<br />MSE: 12.90031<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 426<br />MSE: 13.50608<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 451<br />MSE: 12.65634<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 476<br />MSE: 13.36387<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 501<br />MSE: 12.91171<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 526<br />MSE: 12.93785<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 551<br />MSE: 13.02790<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 576<br />MSE: 12.88126<br />predictors: 7<br />predictors: 7<br />predictors: 7"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(165,138,255,1)","dash":"longdashdot"},"hoveron":"points","name":"7","legendgroup":"7","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,26,51,76,101,126,151,176,201,226,251,276,301,326,351,376,401,426,451,476,501,526,551,576],"y":[18.7287790026247,13.8109805731246,13.8730105994801,14.9131231682735,14.7543041460434,14.1643088771201,13.8650545046038,14.0235497026901,13.5187483572158,14.5877501213954,14.4669967470558,14.0755375096726,14.1877815448516,14.220098355586,14.4249112372478,14.1968511526347,14.0710383780131,14.1670186876829,13.957019898319,13.9256491173259,14.7120238348951,14.3069928578327,13.7578946432719,14.2319280108093],"text":["ntree:   1<br />MSE: 18.72878<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree:  26<br />MSE: 13.81098<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree:  51<br />MSE: 13.87301<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree:  76<br />MSE: 14.91312<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 101<br />MSE: 14.75430<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 126<br />MSE: 14.16431<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 151<br />MSE: 13.86505<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 176<br />MSE: 14.02355<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 201<br />MSE: 13.51875<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 226<br />MSE: 14.58775<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 251<br />MSE: 14.46700<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 276<br />MSE: 14.07554<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 301<br />MSE: 14.18778<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 326<br />MSE: 14.22010<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 351<br />MSE: 14.42491<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 376<br />MSE: 14.19685<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 401<br />MSE: 14.07104<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 426<br />MSE: 14.16702<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 451<br />MSE: 13.95702<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 476<br />MSE: 13.92565<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 501<br />MSE: 14.71202<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 526<br />MSE: 14.30699<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 551<br />MSE: 13.75789<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 576<br />MSE: 14.23193<br />predictors: 9<br />predictors: 9<br />predictors: 9"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(251,97,215,1)","dash":"dash"},"hoveron":"points","name":"9","legendgroup":"9","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8721461187215,"r":7.30593607305936,"b":41.8264840182648,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-27.75,604.75],"tickmode":"array","ticktext":["0","200","400","600"],"tickvals":[3.5527136788005e-15,200,400,600],"categoryorder":"array","categoryarray":["0","200","400","600"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"ntree","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[9.97563490052224,37.6614598234775],"tickmode":"array","ticktext":["10","20","30"],"tickvals":[10,20,30],"categoryorder":"array","categoryarray":["10","20","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"MSE","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.959399606299213},"annotations":[{"text":"predictors","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"e54d5f624a":{"x":{},"y":{},"colour":{},"linetype":{},"type":"scatter"}},"cur_data":"e54d5f624a","visdat":{"e54d5f624a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>When starting off with less trees, we see that the MSE’s for model is
higher. As we increase trees, the MSE drops significantly for all
Models. The model that only uses one predictor seems to have the highest
MSE ranging from 30 - 25. The models with 3, 5 and 7 seem to have the
lowest amount of MSE. Theres no need to have more than 100 Ntrees to get
the lowest MSE.</p>
<p><br /></p>
<h1 id="islr-ch.-8-exercise-9">ISLR Ch. 8, Exercise 9</h1>
<h3 id="a-1">A</h3>
<p><br /></p>
<p>Create a training set containing a random sample of 800 observations,
and a test set containing the remaining observations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## OJ dataset</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.statlearning.com'>ISLR2</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>

<span class='va'>train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>OJ</span><span class='op'>)</span>, <span class='fl'>800</span><span class='op'>)</span>
<span class='co'>#train %&gt;% length()</span>
<span class='va'>OJ.test</span> <span class='op'>&lt;-</span> <span class='va'>OJ</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>
<span class='va'>OJ.response</span> <span class='op'>&lt;-</span> <span class='va'>OJ</span><span class='op'>$</span><span class='va'>Purchase</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span>
<span class='va'>OJ.train</span> <span class='op'>&lt;-</span> <span class='va'>OJ</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>
<span class='va'>OJ.train.response</span> <span class='op'>&lt;-</span> <span class='va'>OJ</span><span class='op'>$</span><span class='va'>Purchase</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>


<span class='co'>#OJ.test %&gt;% dim()</span>
<span class='co'>#OJ.train %&gt;% dim()</span>
<span class='co'>#OJ %&gt;% dim()</span>
<span class='co'>#OJ.response %&gt;% length()</span>
<span class='co'>#OJ.train.response %&gt;% length()</span>
</code></pre>
</div>
</div>
<h3 id="b-3">B</h3>
<p>Fit a tree to the training data, with Purchase as the response and
the other variables as predictors. Use the summary() function to produce
summary statistics about the tree, and describe the results obtained.
What is the training error rate? How many terminal nodes does the tree
have?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>tree</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/attach.html'>attach</a></span><span class='op'>(</span><span class='va'>OJ</span><span class='op'>)</span>
<span class='va'>tree.oj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/tree/man/tree.html'>tree</a></span><span class='op'>(</span><span class='va'>Purchase</span> <span class='op'>~</span><span class='va'>.</span>,data <span class='op'>=</span> <span class='va'>OJ</span>, subset <span class='op'>=</span> <span class='va'>train</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>tree.oj</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Classification tree:
tree(formula = Purchase ~ ., data = OJ, subset = train)
Variables actually used in tree construction:
[1] &quot;LoyalCH&quot;       &quot;PriceDiff&quot;     &quot;SpecialCH&quot;     &quot;ListPriceDiff&quot;
[5] &quot;PctDiscMM&quot;    
Number of terminal nodes:  9 
Residual mean deviance:  0.7432 = 587.8 / 791 
Misclassification error rate: 0.1588 = 127 / 800 </code></pre>
</div>
<p>The training error rate is 16% There are 8 terminal nodes for this
tree. The residual mean deviance is 75%.</p>
<h3 id="c-2">C</h3>
<p>Type in the name of the tree object in order to get a detailed text
output. Pick one of the terminal nodes, and interpret the information
displayed.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree.oj</span>
</code></pre>
</div>
<pre><code>node), split, n, deviance, yval, (yprob)
      * denotes terminal node

 1) root 800 1073.00 CH ( 0.60625 0.39375 )  
   2) LoyalCH &lt; 0.5036 365  441.60 MM ( 0.29315 0.70685 )  
     4) LoyalCH &lt; 0.280875 177  140.50 MM ( 0.13559 0.86441 )  
       8) LoyalCH &lt; 0.0356415 59   10.14 MM ( 0.01695 0.98305 ) *
       9) LoyalCH &gt; 0.0356415 118  116.40 MM ( 0.19492 0.80508 ) *
     5) LoyalCH &gt; 0.280875 188  258.00 MM ( 0.44149 0.55851 )  
      10) PriceDiff &lt; 0.05 79   84.79 MM ( 0.22785 0.77215 )  
        20) SpecialCH &lt; 0.5 64   51.98 MM ( 0.14062 0.85938 ) *
        21) SpecialCH &gt; 0.5 15   20.19 CH ( 0.60000 0.40000 ) *
      11) PriceDiff &gt; 0.05 109  147.00 CH ( 0.59633 0.40367 ) *
   3) LoyalCH &gt; 0.5036 435  337.90 CH ( 0.86897 0.13103 )  
     6) LoyalCH &lt; 0.764572 174  201.00 CH ( 0.73563 0.26437 )  
      12) ListPriceDiff &lt; 0.235 72   99.81 MM ( 0.50000 0.50000 )  
        24) PctDiscMM &lt; 0.196197 55   73.14 CH ( 0.61818 0.38182 ) *
        25) PctDiscMM &gt; 0.196197 17   12.32 MM ( 0.11765 0.88235 ) *
      13) ListPriceDiff &gt; 0.235 102   65.43 CH ( 0.90196 0.09804 ) *
     7) LoyalCH &gt; 0.764572 261   91.20 CH ( 0.95785 0.04215 ) *</code></pre>
</div>
<p>The terminal nodes are shown by the asterix at the end. Lets look at
branch 7. This ends in a terminal node. The split is LoyaCH &gt;
.764572. There are 123.80 observations in this branch. The prediction
for this branch is CH.</p>
<h3 id="d-1">D</h3>
<p>Create a plot of the tree, and interpret the results.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>tree.oj</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='va'>tree.oj</span>, pretty <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="supervised-learning_files/figure-html5/unnamed-chunk-31-1.png" width="624" /></p>
</div>
<p>The criteria most used are loyal CH and price diff.</p>
<h3 id="e-1">e</h3>
<p>Predict the response on the test data, and produce a confusion matrix
comparing the test labels to the predicted test labels. What is the test
error rate?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>tree.oj</span>, <span class='va'>OJ.test</span>, type <span class='op'>=</span> <span class='st'>"class"</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>tree.pred</span>, <span class='va'>OJ.response</span><span class='op'>)</span>


<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>tree.pred</span>,<span class='va'>OJ.response</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">CH</th>
<th style="text-align: right;">MM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CH</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">MM</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">64</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The Test error rate is :"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,<span class='fl'>4</span><span class='op'>)</span>,<span class='st'>"%"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The Test error rate is : 0.1704 %&quot;</code></pre>
</div>
<h3 id="f-g-h">F, G, H</h3>
<p>Apply the cv.tree() function to the training set in order to
determine the optimal tree size.</p>
<p>Produce a plot with tree size on the x-axis and cross-validated
classification error rate on the y-axis.</p>
<p>Which tree size corresponds to the lowest cross-validated
classification error rate?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cv.oj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/tree/man/cv.tree.html'>cv.tree</a></span><span class='op'>(</span><span class='va'>tree.oj</span>, FUN <span class='op'>=</span> <span class='va'>prune.misclass</span> <span class='op'>)</span>


<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.oj</span><span class='op'>$</span><span class='va'>size</span>, <span class='va'>cv.oj</span><span class='op'>$</span><span class='va'>dev</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, xlab <span class='op'>=</span> <span class='st'>"Number of Trees"</span>, ylab <span class='op'>=</span> <span class='st'>"Crossvalidation Error"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>cv.oj</span><span class='op'>$</span><span class='va'>k</span>, <span class='va'>cv.oj</span><span class='op'>$</span><span class='va'>dev</span>, type <span class='op'>=</span> <span class='st'>"b"</span>, xlab <span class='op'>=</span> <span class='st'>"Cross complexity Parameter"</span>, ylab <span class='op'>=</span> <span class='st'>"Crossvalidation Error"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="supervised-learning_files/figure-html5/unnamed-chunk-33-1.png" width="624" /></p>
</div>
<p>According to the figure above, the Crossvalidation error was the
lowest with the number of trees at 8.</p>
<h3 id="i-3">I</h3>
<p>Produce a pruned tree corresponding to the optimal tree size obtained
using cross-validation. If cross-validation does not lead to selection
of a pruned tree, then create a pruned tree with five terminal
nodes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>prune.oj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/tree/man/prune.tree.html'>prune.misclass</a></span><span class='op'>(</span><span class='va'>tree.oj</span>, best <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>prune.oj</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span><span class='op'>(</span><span class='va'>prune.oj</span>, pretty <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="supervised-learning_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<h3 id="j">J</h3>
<p>Compare the training error rates between the pruned and unpruned
trees. Which is higher?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>prune.oj.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>prune.oj</span>, <span class='va'>OJ.train</span>, type <span class='op'>=</span> <span class='st'>"class"</span><span class='op'>)</span>
<span class='va'>prune.oj.pred</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 800</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>OJ.train.response</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 800</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>prune.oj.pred</span>,<span class='va'>OJ.train.response</span><span class='op'>)</span>



 <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>prune.oj.pred</span>,<span class='va'>OJ.train.response</span><span class='op'>)</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">CH</th>
<th style="text-align: right;">MM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CH</td>
<td style="text-align: right;">450</td>
<td style="text-align: right;">92</td>
</tr>
<tr class="even">
<td style="text-align: left;">MM</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">223</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The Test error rate is :"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,<span class='fl'>3</span><span class='op'>)</span>,<span class='st'>"%"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The Test error rate is : 0.159 %&quot;</code></pre>
</div>
<p>The training error rate is slightly less at 15% compared to the 16 %
shown in the original training set.</p>
<h3 id="k">K</h3>
<p>Compare the test error rates between the pruned and unpruned trees.
Which is higher?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>prune.test.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>prune.oj</span>, <span class='va'>OJ.test</span>, type <span class='op'>=</span> <span class='st'>"class"</span><span class='op'>)</span>

<span class='va'>x</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>prune.test.pred</span>,<span class='va'>OJ.response</span><span class='op'>)</span>



 <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>prune.test.pred</span>,<span class='va'>OJ.response</span><span class='op'>)</span><span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">CH</th>
<th style="text-align: right;">MM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CH</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">MM</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">64</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The Test error rate is :"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,<span class='fl'>4</span><span class='op'>)</span>,<span class='st'>"%"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The Test error rate is : 0.1704 %&quot;</code></pre>
</div>
<p>The test error from the pruned tree is the same as the unpruned tree.
We only removed one branch from the original 9 and the CV error rates
looked pretty similar for both.</p>
<p><br /></p>
<h1 id="islr-ch.-8-exercise-10">ISLR Ch. 8, Exercise 10</h1>
<p>We now use boosting to predict Salary in the Hitters data set.</p>
<h3 id="a-2">A</h3>
<p>Remove the observations for whom the salary information is unknown,
and then log-transform the salaries.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Hitters</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Hitters</span><span class='op'>$</span><span class='va'>Salary</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   n
1 59</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Hitters</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 322  20</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Hitters_new</span> <span class='op'>&lt;-</span> <span class='va'>Hitters</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Hitters</span><span class='op'>$</span><span class='va'>Salary</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Hitters_new</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 263  20</code></pre>
</div>
<p>Using !is.na(), I filtered the dataset to filter out all rows with an
NA salary.</p>
<p>Next we will log transform the Salaries</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Hitters_new</span><span class='op'>$</span><span class='va'>Salary</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>Hitters_new</span><span class='op'>$</span><span class='va'>Salary</span><span class='op'>)</span>
<span class='va'>Hitters_new</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                  AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits
-Alan Ashby         315   81     7   24  38    39    14   3449   835
-Alvin Davis        479  130    18   66  72    76     3   1624   457
-Andre Dawson       496  141    20   65  78    37    11   5628  1575
-Andres Galarraga   321   87    10   39  42    30     2    396   101
-Alfredo Griffin    594  169     4   74  51    35    11   4408  1133
-Al Newman          185   37     1   23   8    21     2    214    42
                  CHmRun CRuns CRBI CWalks League Division PutOuts
-Alan Ashby           69   321  414    375      N        W     632
-Alvin Davis          63   224  266    263      A        W     880
-Andre Dawson        225   828  838    354      N        E     200
-Andres Galarraga     12    48   46     33      N        E     805
-Alfredo Griffin      19   501  336    194      A        W     282
-Al Newman             1    30    9     24      N        E      76
                  Assists Errors   Salary NewLeague
-Alan Ashby            43     10 6.163315         N
-Alvin Davis           82     14 6.173786         A
-Andre Dawson          11      3 6.214608         N
-Andres Galarraga      40      4 4.516339         N
-Alfredo Griffin      421     25 6.620073         A
-Al Newman            127      7 4.248495         A</code></pre>
</div>
<h3 id="b-4">B</h3>
<p>Create a training set consisting of the first 200 observations, and a
test set consisting of the remaining observations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>

<span class='va'>train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>Hitters_new</span><span class='op'>)</span>, <span class='fl'>200</span><span class='op'>)</span>
<span class='co'>#train %&gt;% length()</span>

<span class='va'>Hitters.test</span> <span class='op'>&lt;-</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>
<span class='va'>Hitters.response</span> <span class='op'>&lt;-</span> <span class='va'>Hitters_new</span><span class='op'>$</span><span class='va'>Salary</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span>
<span class='va'>Hitters.train</span> <span class='op'>&lt;-</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>
<span class='va'>Hitters.train.response</span> <span class='op'>&lt;-</span> <span class='va'>Hitters_new</span><span class='op'>$</span><span class='va'>Salary</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>


<span class='co'>#Hitters.test %&gt;% dim()</span>
<span class='co'>#Hitters_new %&gt;% dim()</span>
<span class='co'>#Hitters.train.response%&gt;% length()</span>
<span class='co'>#Hitters.response %&gt;% length()</span>
</code></pre>
</div>
</div>
<h3 id="c-3">C</h3>
<p>Perform boosting on the training set with 1,000 trees for a range of
values of the shrinkage parameter λ. Produce a plot with different
shrinkage values on the x-axis and the corresponding training set MSE on
the y-axis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/gbm-developers/gbm'>gbm</a></span><span class='op'>)</span>

<span class='co'>## Example Boost function, summary, and way to calculate MSE</span>
<span class='va'>boost.Hitters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gbm/man/gbm.html'>gbm</a></span><span class='op'>(</span><span class='va'>Salary</span><span class='op'>~</span><span class='va'>.</span>,data <span class='op'>=</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>,
                     distribution <span class='op'>=</span> <span class='st'>"gaussian"</span>, n.trees <span class='op'>=</span> <span class='fl'>1000</span>,
                     interaction.depth <span class='op'>=</span> <span class='fl'>4</span>, shrinkage <span class='op'>=</span> <span class='fl'>.001</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>boost.Hitters</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="supervised-learning_files/figure-html5/unnamed-chunk-40-1.png" width="624" /></p>
<pre><code>                var     rel.inf
CAtBat       CAtBat 28.48705371
CRuns         CRuns 26.44960088
CHits         CHits 11.53406819
CRBI           CRBI  9.37181852
CWalks       CWalks  6.10917041
Hits           Hits  3.05905465
CHmRun       CHmRun  2.19862661
Walks         Walks  2.17115968
HmRun         HmRun  2.01444003
AtBat         AtBat  1.94060681
Years         Years  1.86440763
RBI             RBI  1.73382350
PutOuts     PutOuts  1.62680896
Runs           Runs  0.89988120
Errors       Errors  0.16759670
Assists     Assists  0.12090202
Division   Division  0.11322110
NewLeague NewLeague  0.08105077
League       League  0.05670863</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>yhat.boost</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>boost.Hitters</span>, newdata <span class='op'>=</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>, n.trees <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>
<span class='va'>yhat.boost</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 63</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The MSE test error rate is"</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>yhat.boost</span><span class='op'>-</span> <span class='va'>Hitters.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The MSE test error rate is 0.420831510594534&quot;</code></pre>
</div>
<p>Using the method above, I can now calculate the MSE using the boost
model, yhat predictions and the actual results on the training set. Next
I will create a loop that will run through multiple values of shrinage
and add the calculated MSE’s to a dataframe. I will then plot those
values.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>boost_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"Shrinkage"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>double</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"MSE"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>double</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>


<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.0001</span>, <span class='fl'>.25</span>,<span class='fl'>.01</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>boost.Hitters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gbm/man/gbm.html'>gbm</a></span><span class='op'>(</span><span class='va'>Salary</span><span class='op'>~</span><span class='va'>.</span>,data <span class='op'>=</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>,
                     distribution <span class='op'>=</span> <span class='st'>"gaussian"</span>, n.trees <span class='op'>=</span> <span class='fl'>1000</span>,
                     interaction.depth <span class='op'>=</span> <span class='fl'>4</span>, shrinkage <span class='op'>=</span> <span class='va'>i</span><span class='op'>)</span>
  <span class='va'>yhat.boost</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>boost.Hitters</span>, newdata <span class='op'>=</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>, n.trees <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>
<span class='va'>mse_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>yhat.boost</span><span class='op'>-</span> <span class='va'>Hitters.train.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>


<span class='va'>boost_df</span> <span class='op'>&lt;-</span> <span class='va'>boost_df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/add_row.html'>add_row</a></span><span class='op'>(</span>Shrinkage <span class='op'>=</span> <span class='va'>i</span>, MSE <span class='op'>=</span> <span class='va'>mse_1</span><span class='op'>)</span>
  
<span class='op'>}</span>









<span class='va'>plot</span><span class='op'>&lt;-</span> <span class='va'>boost_df</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Shrinkage</span>, y <span class='op'>=</span> <span class='va'>MSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Shrinkage (lambda)"</span><span class='op'>)</span>

<span class='fu'>plotly</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/plotly/man/ggplotly.html'>ggplotly</a></span><span class='op'>(</span><span class='va'>plot</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-a25fbb6b064121ea3117" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a25fbb6b064121ea3117">{"x":{"data":[{"x":[0.0001,0.0101,0.0201,0.0301,0.0401,0.0501,0.0601,0.0701,0.0801,0.0901,0.1001,0.1101,0.1201,0.1301,0.1401,0.1501,0.1601,0.1701,0.1801,0.1901,0.2001,0.2101,0.2201,0.2301,0.2401],"y":[0.665861327231243,0.0379234798261602,0.0144307205324894,0.0072596447854902,0.00344975971057255,0.00168453714329211,0.000835282591719583,0.000417665506786859,0.000285515859136994,0.000131718353511751,9.27714113673313e-05,4.16776791624866e-05,2.44783876823639e-05,1.1576696795739e-05,8.58353457180432e-06,3.28766728356092e-06,2.91449594811509e-06,1.37631946441906e-06,8.32728768275394e-07,5.78267535350603e-07,3.53992245551131e-07,1.19388320961587e-07,8.84088622687979e-08,7.50714592385369e-08,1.44906879843596e-08],"text":["Shrinkage: 0.0001<br />MSE: 6.658613e-01","Shrinkage: 0.0101<br />MSE: 3.792348e-02","Shrinkage: 0.0201<br />MSE: 1.443072e-02","Shrinkage: 0.0301<br />MSE: 7.259645e-03","Shrinkage: 0.0401<br />MSE: 3.449760e-03","Shrinkage: 0.0501<br />MSE: 1.684537e-03","Shrinkage: 0.0601<br />MSE: 8.352826e-04","Shrinkage: 0.0701<br />MSE: 4.176655e-04","Shrinkage: 0.0801<br />MSE: 2.855159e-04","Shrinkage: 0.0901<br />MSE: 1.317184e-04","Shrinkage: 0.1001<br />MSE: 9.277141e-05","Shrinkage: 0.1101<br />MSE: 4.167768e-05","Shrinkage: 0.1201<br />MSE: 2.447839e-05","Shrinkage: 0.1301<br />MSE: 1.157670e-05","Shrinkage: 0.1401<br />MSE: 8.583535e-06","Shrinkage: 0.1501<br />MSE: 3.287667e-06","Shrinkage: 0.1601<br />MSE: 2.914496e-06","Shrinkage: 0.1701<br />MSE: 1.376319e-06","Shrinkage: 0.1801<br />MSE: 8.327288e-07","Shrinkage: 0.1901<br />MSE: 5.782675e-07","Shrinkage: 0.2001<br />MSE: 3.539922e-07","Shrinkage: 0.2101<br />MSE: 1.193883e-07","Shrinkage: 0.2201<br />MSE: 8.840886e-08","Shrinkage: 0.2301<br />MSE: 7.507146e-08","Shrinkage: 0.2401<br />MSE: 1.449069e-08"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8721461187215,"r":7.30593607305936,"b":41.8264840182648,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0119,0.2521],"tickmode":"array","ticktext":["0.00","0.05","0.10","0.15","0.20","0.25"],"tickvals":[0,0.05,0.1,0.15,0.2,0.25],"categoryorder":"array","categoryarray":["0.00","0.05","0.10","0.15","0.20","0.25"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Shrinkage (lambda)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0332930511463398,0.699154392868271],"tickmode":"array","ticktext":["0.0","0.2","0.4","0.6"],"tickvals":[0,0.2,0.4,0.6],"categoryorder":"array","categoryarray":["0.0","0.2","0.4","0.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"MSE","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"e5461f43391":{"x":{},"y":{},"type":"scatter"}},"cur_data":"e5461f43391","visdat":{"e5461f43391":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<h3 id="d-2">D</h3>
<p>Produce a plot with different shrinkage values on the x-axis and the
corresponding test set MSE on the y-axis.</p>
<p>For this, I will do the exact steps as done in part C, but I will use
the test set instead of the training set when making predicitons.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>boost_df_test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"Shrinkage"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>double</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"MSE"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>double</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>


<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.0001</span>, <span class='fl'>.25</span>,<span class='fl'>.01</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>boost.Hitters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gbm/man/gbm.html'>gbm</a></span><span class='op'>(</span><span class='va'>Salary</span><span class='op'>~</span><span class='va'>.</span>,data <span class='op'>=</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>,
                     distribution <span class='op'>=</span> <span class='st'>"gaussian"</span>, n.trees <span class='op'>=</span> <span class='fl'>1000</span>,
                     interaction.depth <span class='op'>=</span> <span class='fl'>4</span>, shrinkage <span class='op'>=</span> <span class='va'>i</span><span class='op'>)</span>
  <span class='va'>yhat.boost</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>boost.Hitters</span>, newdata <span class='op'>=</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>, n.trees <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>
<span class='va'>mse_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>yhat.boost</span><span class='op'>-</span> <span class='va'>Hitters.test</span><span class='op'>$</span><span class='va'>Salary</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>

<span class='va'>boost_df_test</span> <span class='op'>&lt;-</span> <span class='va'>boost_df_test</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/add_row.html'>add_row</a></span><span class='op'>(</span>Shrinkage <span class='op'>=</span> <span class='va'>i</span>, MSE <span class='op'>=</span> <span class='va'>mse_1</span><span class='op'>)</span>
  
<span class='op'>}</span>


<span class='va'>plot</span><span class='op'>&lt;-</span> <span class='va'>boost_df_test</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Shrinkage</span>, y <span class='op'>=</span> <span class='va'>MSE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Shrinkage (lambda)"</span><span class='op'>)</span>

<span class='fu'>plotly</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/plotly/man/ggplotly.html'>ggplotly</a></span><span class='op'>(</span><span class='va'>plot</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-9a64231b10a561380410" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9a64231b10a561380410">{"x":{"data":[{"x":[0.0001,0.0101,0.0201,0.0301,0.0401,0.0501,0.0601,0.0701,0.0801,0.0901,0.1001,0.1101,0.1201,0.1301,0.1401,0.1501,0.1601,0.1701,0.1801,0.1901,0.2001,0.2101,0.2201,0.2301,0.2401],"y":[0.776404949431054,0.377468213068746,0.389109787753448,0.397285920230495,0.398521711253916,0.392998980345278,0.411981165955552,0.411056091167511,0.40978317154764,0.424797677427592,0.424781638545013,0.403721699223818,0.442243230922348,0.411557203950517,0.434448046097555,0.436631619422199,0.415804628242507,0.442882398988851,0.442741487743061,0.441862464416142,0.398775869459989,0.447842056881034,0.424421198723408,0.409074194786413,0.448232315646583],"text":["Shrinkage: 0.0001<br />MSE: 0.7764049","Shrinkage: 0.0101<br />MSE: 0.3774682","Shrinkage: 0.0201<br />MSE: 0.3891098","Shrinkage: 0.0301<br />MSE: 0.3972859","Shrinkage: 0.0401<br />MSE: 0.3985217","Shrinkage: 0.0501<br />MSE: 0.3929990","Shrinkage: 0.0601<br />MSE: 0.4119812","Shrinkage: 0.0701<br />MSE: 0.4110561","Shrinkage: 0.0801<br />MSE: 0.4097832","Shrinkage: 0.0901<br />MSE: 0.4247977","Shrinkage: 0.1001<br />MSE: 0.4247816","Shrinkage: 0.1101<br />MSE: 0.4037217","Shrinkage: 0.1201<br />MSE: 0.4422432","Shrinkage: 0.1301<br />MSE: 0.4115572","Shrinkage: 0.1401<br />MSE: 0.4344480","Shrinkage: 0.1501<br />MSE: 0.4366316","Shrinkage: 0.1601<br />MSE: 0.4158046","Shrinkage: 0.1701<br />MSE: 0.4428824","Shrinkage: 0.1801<br />MSE: 0.4427415","Shrinkage: 0.1901<br />MSE: 0.4418625","Shrinkage: 0.2001<br />MSE: 0.3987759","Shrinkage: 0.2101<br />MSE: 0.4478421","Shrinkage: 0.2201<br />MSE: 0.4244212","Shrinkage: 0.2301<br />MSE: 0.4090742","Shrinkage: 0.2401<br />MSE: 0.4482323"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8721461187215,"r":7.30593607305936,"b":41.8264840182648,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0119,0.2521],"tickmode":"array","ticktext":["0.00","0.05","0.10","0.15","0.20","0.25"],"tickvals":[0,0.05,0.1,0.15,0.2,0.25],"categoryorder":"array","categoryarray":["0.00","0.05","0.10","0.15","0.20","0.25"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Shrinkage (lambda)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.357521376250631,0.796351786249169],"tickmode":"array","ticktext":["0.4","0.5","0.6","0.7"],"tickvals":[0.4,0.5,0.6,0.7],"categoryorder":"array","categoryarray":["0.4","0.5","0.6","0.7"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"MSE","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"e54fe474c0":{"x":{},"y":{},"type":"scatter"}},"cur_data":"e54fe474c0","visdat":{"e54fe474c0":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>boost_df_test</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>MSE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 x 1
  `min(MSE)`
       &lt;dbl&gt;
1      0.377</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.min</a></span><span class='op'>(</span><span class='va'>boost_df_test</span><span class='op'>$</span><span class='va'>MSE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>boost_df_test</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.min</a></span><span class='op'>(</span><span class='va'>boost_df_test</span><span class='op'>$</span><span class='va'>MSE</span><span class='op'>)</span>,<span class='op'>]</span>
</code></pre>
</div>
<pre><code># A tibble: 1 x 2
  Shrinkage   MSE
      &lt;dbl&gt; &lt;dbl&gt;
1    0.0101 0.377</code></pre>
</div>
<p>Min MSE can be found at .0101 Lamda.</p>
<h3 id="e-2">E</h3>
<p>Compare the test MSE of boosting to the test MSE that results from
applying two of the regression approaches seen in Chapters 3 and 6.</p>
<p>For this I decided to use multiple models from ch. 3 and ch. 6. See
below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>

<span class='co'>## Linear Model</span>

<span class='va'>Hitters_new</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                  AtBat Hits HmRun Runs RBI Walks Years CAtBat CHits
-Alan Ashby         315   81     7   24  38    39    14   3449   835
-Alvin Davis        479  130    18   66  72    76     3   1624   457
-Andre Dawson       496  141    20   65  78    37    11   5628  1575
-Andres Galarraga   321   87    10   39  42    30     2    396   101
-Alfredo Griffin    594  169     4   74  51    35    11   4408  1133
-Al Newman          185   37     1   23   8    21     2    214    42
                  CHmRun CRuns CRBI CWalks League Division PutOuts
-Alan Ashby           69   321  414    375      N        W     632
-Alvin Davis          63   224  266    263      A        W     880
-Andre Dawson        225   828  838    354      N        E     200
-Andres Galarraga     12    48   46     33      N        E     805
-Alfredo Griffin      19   501  336    194      A        W     282
-Al Newman             1    30    9     24      N        E      76
                  Assists Errors   Salary NewLeague
-Alan Ashby            43     10 6.163315         N
-Alvin Davis           82     14 6.173786         A
-Andre Dawson          11      3 6.214608         N
-Andres Galarraga      40      4 4.516339         N
-Alfredo Griffin      421     25 6.620073         A
-Al Newman            127      7 4.248495         A</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lm.fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>Salary</span> <span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Hitters_new</span>, subset <span class='op'>=</span> <span class='va'>train</span><span class='op'>)</span>
<span class='va'>lm.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lm.fit</span>, <span class='va'>Hitters_new</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>, type <span class='op'>=</span> <span class='st'>"response"</span><span class='op'>)</span>
<span class='va'>lm_mse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>lm.pred</span> <span class='op'>-</span> <span class='va'>Hitters.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The Linear Model MSE is: "</span>,<span class='va'>lm_mse</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The Linear Model MSE is:  0.576163818320103&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>"model"</span> <span class='op'>=</span> <span class='st'>"Least Square"</span>, <span class='st'>"MSE"</span> <span class='op'>=</span> <span class='va'>lm_mse</span><span class='op'>)</span>



<span class='co'>## Boost</span>
 <span class='va'>boost.Hitters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gbm/man/gbm.html'>gbm</a></span><span class='op'>(</span><span class='va'>Salary</span><span class='op'>~</span><span class='va'>.</span>,data <span class='op'>=</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>,
                     distribution <span class='op'>=</span> <span class='st'>"gaussian"</span>, n.trees <span class='op'>=</span> <span class='fl'>1000</span>,
                     interaction.depth <span class='op'>=</span> <span class='fl'>4</span>, shrinkage <span class='op'>=</span> <span class='fl'>.0101</span><span class='op'>)</span>
  <span class='va'>yhat.boost</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>boost.Hitters</span>, newdata <span class='op'>=</span> <span class='va'>Hitters_new</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span>, n.trees <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>
<span class='va'>mse_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>yhat.boost</span><span class='op'>-</span> <span class='va'>Hitters.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>


<span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Boosting"</span>,<span class='va'>mse_1</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The test Error Rate for Boosting is : "</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>yhat.boost</span> <span class='op'>-</span> <span class='va'>Hitters.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The test Error Rate for Boosting is :  0.382735329466136&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## Ridge</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>Salary</span><span class='op'>~</span><span class='va'>.</span>,<span class='va'>Hitters_new</span><span class='op'>)</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>Hitters_new</span><span class='op'>$</span><span class='va'>Salary</span>
<span class='va'>grid</span> <span class='op'>&lt;-</span> <span class='fl'>10</span><span class='op'>^</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>,<span class='op'>-</span><span class='fl'>2</span>, length <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='va'>ridge.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>, <span class='va'>y</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>, alpha <span class='op'>=</span><span class='fl'>0</span>, lambda <span class='op'>=</span> <span class='va'>grid</span> <span class='op'>)</span>
<span class='va'>cv.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>, <span class='va'>y</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>,alpha <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
<span class='va'>lamda_best</span> <span class='op'>&lt;-</span> <span class='va'>cv.out</span><span class='op'>$</span><span class='va'>lambda.min</span>
<span class='va'>ridge.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge.mod</span>, s <span class='op'>=</span> <span class='va'>lamda_best</span>, newx <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='va'>ridge_mse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ridge"</span>,<span class='va'>ridge_mse</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The test Error Rate for Ridge is : "</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>ridge.pred</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The test Error Rate for Ridge is :  0.581396338527786&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>## Lasso</span>

<span class='va'>lasso.mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>,<span class='va'>y</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>,alpha <span class='op'>=</span> <span class='fl'>1</span>, lambda <span class='op'>=</span> <span class='va'>grid</span><span class='op'>)</span>
<span class='va'>cv.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>train</span>,<span class='op'>]</span>, <span class='va'>y</span><span class='op'>[</span><span class='va'>train</span><span class='op'>]</span>, alpha <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>lamda_best</span> <span class='op'>&lt;-</span> <span class='va'>cv.out</span><span class='op'>$</span><span class='va'>lambda.min</span>
<span class='va'>lasso.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lasso.mod</span>, s<span class='op'>=</span> <span class='va'>lamda_best</span>, newx <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span>,<span class='op'>]</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The test error rate for lasso "</span>,<span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>lasso.pred</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The test error rate for lasso  0.575921346257875&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lasso_mse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>lasso.pred</span> <span class='op'>-</span> <span class='va'>y</span><span class='op'>[</span><span class='op'>-</span><span class='va'>train</span><span class='op'>]</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Lasso"</span>,<span class='va'>lasso_mse</span><span class='op'>)</span><span class='op'>)</span>



<span class='co'>## PCR</span>

<span class='va'>pcr.fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/pls/man/mvr.html'>pcr</a></span><span class='op'>(</span><span class='va'>Salary</span> <span class='op'>~</span> <span class='va'>.</span> , data <span class='op'>=</span> <span class='va'>Hitters_new</span>, subset <span class='op'>=</span> <span class='va'>train</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, validation <span class='op'>=</span> <span class='st'>"CV"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/pls/man/validationplot.html'>validationplot</a></span><span class='op'>(</span><span class='va'>pcr.fit</span>,val.type <span class='op'>=</span> <span class='st'>"MSEP"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="supervised-learning_files/figure-html5/unnamed-chunk-43-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pcr.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>pcr.fit</span>,<span class='va'>Hitters.test</span>, ncomp <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
<span class='va'>pcr_mse</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>pcr.pred</span> <span class='op'>-</span> <span class='va'>Hitters.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='co'># lowest MSEP at 10 componenets.</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The MSE error for PCR is "</span>, <span class='va'>pcr_mse</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The MSE error for PCR is  0.619877318874639&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PCR"</span>,<span class='va'>pcr_mse</span><span class='op'>)</span><span class='op'>)</span>



<span class='co'>## PLS</span>

<span class='va'>pls.fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/pls/man/mvr.html'>plsr</a></span><span class='op'>(</span><span class='va'>Salary</span><span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Hitters_new</span>, subset <span class='op'>=</span> <span class='va'>train</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, validation <span class='op'>=</span> <span class='st'>"CV"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/pls/man/validationplot.html'>validationplot</a></span><span class='op'>(</span><span class='va'>pls.fit</span>, val.type <span class='op'>=</span> <span class='st'>"MSEP"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="supervised-learning_files/figure-html5/unnamed-chunk-43-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Lowest  MSEP at 5 components</span>
<span class='va'>pls.pred_7</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>pls.fit</span>, <span class='va'>Hitters.test</span>, ncomp <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The MSE error using M as 5: "</span>, <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>pls.pred_7</span><span class='op'>-</span> <span class='va'>Hitters.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The MSE error using M as 5:  0.617966162736438&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pls_mse</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>pls.pred_7</span><span class='op'>-</span> <span class='va'>Hitters.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>MSE_dataframe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PLS"</span>,<span class='va'>pls_mse</span><span class='op'>)</span><span class='op'>)</span>




<span class='co'>#MSE_dataframe %&gt;% arrange(MSE)</span>
<span class='va'>MSE_dataframe</span><span class='op'>$</span><span class='va'>MSE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>MSE_dataframe</span><span class='op'>$</span><span class='va'>MSE</span><span class='op'>)</span>

<span class='va'>MSE_dataframe</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>model</span>, y <span class='op'>=</span> <span class='va'>MSE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"deepskyblue3"</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"MSE per Model"</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>MSE</span><span class='op'>)</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>, vjust <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="supervised-learning_files/figure-html5/unnamed-chunk-43-3.png" width="624" /></p>
</div>
<p>Boosting the model will give us the lowest MSE, with PCR in second
place. Boosting is the model of choice by far compared to the other
models.</p>
<h3 id="f-1">F</h3>
<p>Which variables appear to be the most important predictors in the
boosted model?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>boost.Hitters</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="supervised-learning_files/figure-html5/unnamed-chunk-44-1.png" width="624" /></p>
<pre><code>                var    rel.inf
CAtBat       CAtBat 21.3776399
CRuns         CRuns 18.4554725
CHits         CHits  9.4230585
CRBI           CRBI  9.1617592
CWalks       CWalks  7.1643822
Years         Years  5.2568153
CHmRun       CHmRun  4.2210637
Walks         Walks  3.0531623
PutOuts     PutOuts  3.0017692
AtBat         AtBat  2.9358935
Hits           Hits  2.8943762
Errors       Errors  2.7801941
RBI             RBI  2.7298938
HmRun         HmRun  2.5411422
Runs           Runs  2.1241977
Assists     Assists  1.5876161
Division   Division  0.4762580
NewLeague NewLeague  0.4306447
League       League  0.3846610</code></pre>
</div>
<p>At bat and runs have the most influence.</p>
<h3 id="g-1">G</h3>
<p>Now apply bagging to the training set. What is the test set MSE for
this approach?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>


<span class='va'>bag_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='st'>"predictors"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>,<span class='st'>"ntree"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>double</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"MSE"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>double</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>



<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>19</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>for</span><span class='op'>(</span><span class='va'>x</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>600</span>,<span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>bag.hitters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/randomForest/man/randomForest.html'>randomForest</a></span><span class='op'>(</span><span class='va'>Salary</span> <span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Hitters.train</span>, mtry <span class='op'>=</span> <span class='va'>i</span>,ntree <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>
<span class='va'>yhat.bag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>bag.hitters</span>, newdata <span class='op'>=</span> <span class='va'>Hitters.test</span><span class='op'>)</span>
<span class='va'>mse_1</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>yhat.bag</span><span class='op'>-</span> <span class='va'>Hitters.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>bag_data</span> <span class='op'>&lt;-</span><span class='va'>bag_data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/add_row.html'>add_row</a></span><span class='op'>(</span>predictors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span>,ntree <span class='op'>=</span> <span class='va'>x</span>, MSE <span class='op'>=</span> <span class='va'>mse_1</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>}</span>

<span class='va'>plot</span><span class='op'>&lt;-</span> <span class='va'>bag_data</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>ntree</span>, y <span class='op'>=</span> <span class='va'>MSE</span>, group <span class='op'>=</span> <span class='va'>predictors</span>,color <span class='op'>=</span> <span class='va'>predictors</span>, linetype <span class='op'>=</span> <span class='va'>predictors</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>plotly</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/plotly/man/ggplotly.html'>ggplotly</a></span><span class='op'>(</span><span class='va'>plot</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-05149644d24b989b60d8" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-05149644d24b989b60d8">{"x":{"data":[{"x":[1,101,201,301,401,501],"y":[0.43171395670545,0.406888206779161,0.38835026613887,0.394957294443029,0.391269651648264,0.39293152140034],"text":["ntree:   1<br />MSE: 0.4317140<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 101<br />MSE: 0.4068882<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 201<br />MSE: 0.3883503<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 301<br />MSE: 0.3949573<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 401<br />MSE: 0.3912697<br />predictors: 1<br />predictors: 1<br />predictors: 1","ntree: 501<br />MSE: 0.3929315<br />predictors: 1<br />predictors: 1<br />predictors: 1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,101,201,301,401,501],"y":[0.661173726164936,0.397066154375408,0.362048665909562,0.358341413030472,0.367815443344352,0.363345651573596],"text":["ntree:   1<br />MSE: 0.6611737<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 101<br />MSE: 0.3970662<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 201<br />MSE: 0.3620487<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 301<br />MSE: 0.3583414<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 401<br />MSE: 0.3678154<br />predictors: 11<br />predictors: 11<br />predictors: 11","ntree: 501<br />MSE: 0.3633457<br />predictors: 11<br />predictors: 11<br />predictors: 11"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"dash"},"hoveron":"points","name":"11","legendgroup":"11","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,101,201,301,401,501],"y":[0.658288916933541,0.347060609906192,0.364754790637257,0.359946094273967,0.361640653629599,0.364537790832377],"text":["ntree:   1<br />MSE: 0.6582889<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 101<br />MSE: 0.3470606<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 201<br />MSE: 0.3647548<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 301<br />MSE: 0.3599461<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 401<br />MSE: 0.3616407<br />predictors: 13<br />predictors: 13<br />predictors: 13","ntree: 501<br />MSE: 0.3645378<br />predictors: 13<br />predictors: 13<br />predictors: 13"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"13","legendgroup":"13","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,101,201,301,401,501],"y":[0.49514177324075,0.370200746381667,0.363540704420413,0.361785301393901,0.360282087622746,0.368491273097209],"text":["ntree:   1<br />MSE: 0.4951418<br />predictors: 15<br />predictors: 15<br />predictors: 15","ntree: 101<br />MSE: 0.3702007<br />predictors: 15<br />predictors: 15<br />predictors: 15","ntree: 201<br />MSE: 0.3635407<br />predictors: 15<br />predictors: 15<br />predictors: 15","ntree: 301<br />MSE: 0.3617853<br />predictors: 15<br />predictors: 15<br />predictors: 15","ntree: 401<br />MSE: 0.3602821<br />predictors: 15<br />predictors: 15<br />predictors: 15","ntree: 501<br />MSE: 0.3684913<br />predictors: 15<br />predictors: 15<br />predictors: 15"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"dashdot"},"hoveron":"points","name":"15","legendgroup":"15","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,101,201,301,401,501],"y":[0.526273744475996,0.35950692757155,0.359311412713107,0.369429456885847,0.365785126558743,0.360859328139336],"text":["ntree:   1<br />MSE: 0.5262737<br />predictors: 17<br />predictors: 17<br />predictors: 17","ntree: 101<br />MSE: 0.3595069<br />predictors: 17<br />predictors: 17<br />predictors: 17","ntree: 201<br />MSE: 0.3593114<br />predictors: 17<br />predictors: 17<br />predictors: 17","ntree: 301<br />MSE: 0.3694295<br />predictors: 17<br />predictors: 17<br />predictors: 17","ntree: 401<br />MSE: 0.3657851<br />predictors: 17<br />predictors: 17<br />predictors: 17","ntree: 501<br />MSE: 0.3608593<br />predictors: 17<br />predictors: 17<br />predictors: 17"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"longdash"},"hoveron":"points","name":"17","legendgroup":"17","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,101,201,301,401,501],"y":[0.481039970852711,0.379086606019541,0.368019988076372,0.359608427537105,0.372666813244621,0.370620367912294],"text":["ntree:   1<br />MSE: 0.4810400<br />predictors: 19<br />predictors: 19<br />predictors: 19","ntree: 101<br />MSE: 0.3790866<br />predictors: 19<br />predictors: 19<br />predictors: 19","ntree: 201<br />MSE: 0.3680200<br />predictors: 19<br />predictors: 19<br />predictors: 19","ntree: 301<br />MSE: 0.3596084<br />predictors: 19<br />predictors: 19<br />predictors: 19","ntree: 401<br />MSE: 0.3726668<br />predictors: 19<br />predictors: 19<br />predictors: 19","ntree: 501<br />MSE: 0.3706204<br />predictors: 19<br />predictors: 19<br />predictors: 19"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"longdashdot"},"hoveron":"points","name":"19","legendgroup":"19","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,101,201,301,401,501],"y":[0.61417411004752,0.372236226979121,0.368948611943404,0.362922284804175,0.358775690435265,0.370532894636705],"text":["ntree:   1<br />MSE: 0.6141741<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 101<br />MSE: 0.3722362<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 201<br />MSE: 0.3689486<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 301<br />MSE: 0.3629223<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 401<br />MSE: 0.3587757<br />predictors: 3<br />predictors: 3<br />predictors: 3","ntree: 501<br />MSE: 0.3705329<br />predictors: 3<br />predictors: 3<br />predictors: 3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"dash"},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,101,201,301,401,501],"y":[0.868157355329765,0.367166134779675,0.36291527410717,0.367454466896753,0.362269143984216,0.354995554790265],"text":["ntree:   1<br />MSE: 0.8681574<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 101<br />MSE: 0.3671661<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 201<br />MSE: 0.3629153<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 301<br />MSE: 0.3674545<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 401<br />MSE: 0.3622691<br />predictors: 5<br />predictors: 5<br />predictors: 5","ntree: 501<br />MSE: 0.3549956<br />predictors: 5<br />predictors: 5<br />predictors: 5"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)","dash":"dashdot"},"hoveron":"points","name":"5","legendgroup":"5","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,101,201,301,401,501],"y":[0.963598359013147,0.35257182218199,0.355642502239179,0.350693194525137,0.363054250887282,0.368009632771206],"text":["ntree:   1<br />MSE: 0.9635984<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 101<br />MSE: 0.3525718<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 201<br />MSE: 0.3556425<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 301<br />MSE: 0.3506932<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 401<br />MSE: 0.3630543<br />predictors: 7<br />predictors: 7<br />predictors: 7","ntree: 501<br />MSE: 0.3680096<br />predictors: 7<br />predictors: 7<br />predictors: 7"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"dashdot"},"hoveron":"points","name":"7","legendgroup":"7","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,101,201,301,401,501],"y":[0.507282568957107,0.359309921576958,0.361063111593749,0.359500087972263,0.360198260789674,0.354346776110049],"text":["ntree:   1<br />MSE: 0.5072826<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 101<br />MSE: 0.3593099<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 201<br />MSE: 0.3610631<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 301<br />MSE: 0.3595001<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 401<br />MSE: 0.3601983<br />predictors: 9<br />predictors: 9<br />predictors: 9","ntree: 501<br />MSE: 0.3543468<br />predictors: 9<br />predictors: 9<br />predictors: 9"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)","dash":"dash"},"hoveron":"points","name":"9","legendgroup":"9","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8721461187215,"r":7.30593607305936,"b":41.8264840182648,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-24,526],"tickmode":"array","ticktext":["0","100","200","300","400","500"],"tickvals":[3.5527136788005e-15,100,200,300,400,500],"categoryorder":"array","categoryarray":["0","100","200","300","400","500"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"ntree","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.316233722450844,0.994425246468495],"tickmode":"array","ticktext":["0.4","0.6","0.8"],"tickvals":[0.4,0.6,0.8],"categoryorder":"array","categoryarray":["0.4","0.6","0.8"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"MSE","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.959399606299213},"annotations":[{"text":"predictors","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"e5446315c07":{"x":{},"y":{},"colour":{},"linetype":{},"type":"scatter"}},"cur_data":"e5446315c07","visdat":{"e5446315c07":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Based on the plot, we should use 13 predictors and 100 trees.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"> <span class='va'>bag.hitters</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/randomForest/man/randomForest.html'>randomForest</a></span><span class='op'>(</span><span class='va'>Salary</span> <span class='op'>~</span><span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>Hitters.train</span>, mtry <span class='op'>=</span> <span class='fl'>13</span>,ntree <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
<span class='va'>yhat.bag</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>bag.hitters</span>, newdata <span class='op'>=</span> <span class='va'>Hitters.test</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"The MSE for bagging is : "</span>,<span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>yhat.bag</span><span class='op'>-</span> <span class='va'>Hitters.response</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;The MSE for bagging is :  0.362244453542562&quot;</code></pre>
</div>
<p>The .3622 is slightly lower than the boosting MSE of .38.</p>
<h2 id="final-project-ideas">Final Project IDEAS</h2>
<p>Identify a data set that you plan to use for your project/poster and
your likely collaborators. What outcome of interest do will you attempt
to predict? Why do you expect that the available features (variables),
or some subset of them, should help predict this outcome?</p>
<p>For the project, I plan to work alone. If I do stumble on certain
problems, I will reach out via Piazza or I will go in for office
hours.</p>
<p>For my dataset I went to Kaggle.com. I’m not entirely sure what data
set I will use. I found the following data sets that I could possibly
use:</p>
<p>For a descrete analysis I could use the Amazon seller dataset from
Kagle. This data set is trying to predict whether an amazon order will
go through. <a
href="https://www.kaggle.com/pranalibose/amazon-seller-order-status-prediction"
class="uri">https://www.kaggle.com/pranalibose/amazon-seller-order-status-prediction</a>
This data set was created with the purpose of predicting order
sucesses.</p>
<p>I’d also like to possibly use stock data and indicators to predict
whether a stock will increase or decrease, and to predict future prices.
I know that a lot of people use technical indicators to make buy and
sell decisions. I’d like to give that an attempt as well.</p>
<p>I also found another data set that was interesting from Kagle. This
data set looks at wind power. This data set is trying to predict how
much wind is generated by the windmill in the following 15 days. <a
href="https://www.kaggle.com/theforcecoder/wind-power-forecasting"
class="uri">https://www.kaggle.com/theforcecoder/wind-power-forecasting</a></p>
<div class="sourceCode" id="cb69"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
